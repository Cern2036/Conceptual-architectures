Техническое задание (Technical Specification)

Project ZERO-1: Прототип автономной петли коэволюционного харденинга для сетевого оборудования

Версия: 1.0
Дата: 21 декабря 2025 г.
Разработчик фреймворка: E. Veles
1. ВВЕДЕНИЕ И ЦЕЛИ ПРОЕКТА

1.1. Контекст и обоснование.
Современный процесс аудита и харденинга конфигураций сетевого оборудования (Cisco, Juniper) в соответствии с профилями безопасности (DISA STIG, CIS Benchmarks) является преимущественно ручным. Это приводит к следующим проблемам:

    Высокая стоимость: Требуется привлечение высокооплачиваемых экспертов-сетевиков и security-аналитиков.

    Низкая скорость: Ручная проверка тысяч строк конфигурации занимает дни и недели.

    Человеческий фактор: Высокая вероятность пропуска ошибок из-за усталости или невнимательности.

    Сложность верификации: Отсутствие технически неопровержимого доказательства того, что найденная проблема была устранена корректно.

Project ZERO-1 призван продемонстрировать возможность автоматизации этого процесса через создание прототипа, реализующего одну замкнутую петлю.

1.2. Цель MVP.
Разработать и продемонстрировать работоспособный прототип программно-аппаратного комплекса, который в полностью автоматическом режиме выполняет полный цикл действий для одной заданной уязвимости конфигурации сетевого оборудования Cisco IOS XE:

    Обнаружение (Discovery): Автономный анализ конфигурации устройства на соответствие стандарту DISA STIG.

    Эксплуатация (Exploitation): Автоматическая проверка эксплуатируемости найденной уязвимости с целью доказательства ее критичности.

    Синтез исправления (Remediation Synthesis): Автоматическая генерация корректного конфигурационного патча на основе анализа успешной атаки.

    Верификация (Verification): Автоматическое применение патча и повторное тестирование для подтверждения его эффективности.

    Формирование доказательств (Evidence Generation): Создание криптографически верифицируемого отчета, содержащего полную цепочку действий и их результатов.

1.3. Ключевые отличия от существующих решений.
Инструмент / Подход	Принцип работы	Ограничение	Решение ZERO-1
Статические анализаторы (Nipper, Nessus)	Пассивный парсинг конфигурационного файла.	Не могут проверить эксплуатируемость находки. Не генерируют готовое исправление.	Активное доказательство уязвимости через симуляцию атаки и автоматическая генерация патча.
Ручной пентест	Эксперт вручную проводит разведку, эксплуатацию и анализ.	Не масштабируется, зависит от квалификации эксперта, субъективно.	Полная автоматизация цикла, исключающая человеческий фактор на этапе выполнения.
Конфигурационные менеджеры (Ansible, Terraform)	Применяют заранее заданный "желаемый" state.	Требуют, чтобы этот state был заранее известен и корректно описан экспертом.	Автономное обнаружение отклонений от эталона и синтез desired state для конкретного найденного отклонения.

1.4. Определение успеха для MVP.
Проект считается успешным, если разработанный прототип за три последовательных полностью автоматических запуска (без вмешательства оператора после старта) демонстрирует следующие результаты:

    Цикл 1: Обнаружение уязвимости V-220668 -> Успешная демонстрация ее эксплуатации -> Корректная генерация патча -> Успешное применение -> Подтверждение блокировки уязвимости при повторной проверке -> Формирование валидного доказательного отчета.

    Циклы 2 и 3: Стабильное повторение результатов Цикла 1 с идентичными метриками.

    Общее время выполнения одного полного цикла не превышает 120 минут.

2. ВЫБОР ЦЕЛЕВОЙ УЯЗВИМОСТИ И ТЕСТОВАЯ СРЕДА

2.1. Обоснование выбора уязвимости.
Для MVP выбрано нарушение DISA STIG ID V-220668 из профиля для Cisco IOS XE Switch L2S (версия 3, релиз от 19.05.2025).

    Формулировка: "The Cisco switch must not have the default VLAN assigned to any host-facing access ports."

    Техническая суть: Наличие порта в режиме access, назначенного в VLAN 1 (VLAN по умолчанию), является распространенной ошибкой. Это упрощает проведение атак типа VLAN Hopping (Double Tagging) и расширяет зону атаки в случае компрометации любого устройства в VLAN 1.

    Причины выбора для MVP:

        Четкая идентификация: Уязвимость легко выявляется по командам show run interface и show vlan.

        Простота эксплуатации: Факт уязвимости может быть доказан простой проверкой сетевой связности (ICMP, TCP) с целевым хостом в VLAN 1.

        Однозначное исправление: Лечится строго определенной последовательностью команд IOS (перенос порта в ненулевую VLAN).

        Высокая распространенность: Является типовым finding в реальных аудитах.

2.2. Спецификация тестовой лабораторной среды.
Среда должна быть полностью изолирована от продуктивных сетей и воспроизводима "одной кнопкой".

    2.2.1. Физическая и виртуальная инфраструктура.

        Хост-сервер: Выделенный сервер или мощная виртуальная машина.

            CPU: 16 ядер (Intel Xeon Silver 4314 / AMD EPYC 7313).

            RAM: 128 ГБ DDR4 ECC.

            GPU: 1x NVIDIA RTX A6000 (48 ГБ) или 2x NVIDIA RTX 4090 (24 ГБ) для одновременного инференса двух моделей LLM.

            Хранилище: 2 ТБ NVMe SSD (RAID 1).

            Сетевая карта: 2x 10 GbE (одна для управления, одна для изолированного стенда).

        Программная платформа хоста:

            ОС: Ubuntu Server 22.04.3 LTS.

            Гипервизор: VMware ESXi 8.0 U2 (или KVM/QEMU, если используется bare-metal).

            Платформа сетевой эмуляции: EVE-NG Professional 5.0-1-26. Выбор обусловлен профессиональной поддержкой образов Cisco, стабильностью и возможностями интеграции через API.

            Контейнеризация: Docker 24.0.7, Docker Compose v2.23.3.

            Управление: Python 3.11.7, Ansible Core 2.16.4, Terraform 1.6.6.

    2.2.2. Виртуальная тестовая сеть (EVE-NG Lab).
    Создается топология "Звезда":
    text

    [Атакующий хост (Ubuntu)] ----- [Cisco CSR1000v] ----- [Целевой сервер (Ubuntu в VLAN 1)]
           (Management Net)                 (Lab Network)                     (Lab Network)

Сетевое оборудование:

    Модель: Cisco Cloud Services Router (CSR) 1000V.

    Версия ПО: IOS XE 17.09.04a (VIRL-17.09.04a).

    Конфигурация (исходная, уязвимая):
    cisco

hostname ZERO1-TARGET-SWITCH
!
vlan 100
 name REMEDIATION_VLAN
!
interface GigabitEthernet1
 description TO_ATTACKER_HOST
 no ip address
 negotiation auto
 no cdp enable
!
interface GigabitEthernet2
 description TO_TARGET_SERVER
 switchport mode access
 switchport access vlan 1  <--- НАРУШЕНИЕ STIG V-220668
 negotiation auto
 no cdp enable
!
interface Vlan1
 ip address 192.168.1.1 255.255.255.0
!
interface Vlan100
 ip address 192.168.100.1 255.255.255.0
!
ip route 0.0.0.0 0.0.0.0 192.168.1.254
line vty 0 4
 password cisco
 login local

        Хосты в лаборатории:

            Атакующий хост (Attacker): Виртуальная машина Ubuntu 22.04. Назначен IP в management сети EVE-NG (например, 192.168.255.10). На нем запускаются все управляющие скрипты и агенты проекта ZERO-1.

            Целевой сервер (Target): Виртуальная машина Ubuntu 22.04. Назначен IP 192.168.1.100 в VLAN 1. На сервере запущен простой HTTP-сервер (nginx) и разрешены ответы на ICMP-запросы. Является индикатором успешной эксплуатации.

    2.2.3. Автоматизация развертывания.
    Вся лаборатория описывается как код (Infrastructure as Code).

        Terraform: Основной инструмент. Используется кастомный провайдер для EVE-NG API (или управление через ssh и expect-скрипты). Конфигурация (main.tf) определяет:

            Создание нового проекта zero1-mvp.

            Добавление узлов (CSR1000v, Ubuntu VMs).

            Создание сетевых связей.

            Запуск узлов.

        Ansible: Используется для post-deploy настройки:

            Загрузка начальной уязвимой конфигурации на CSR1000v.

            Настройка IP-адресов и сервисов на виртуальных машинах Ubuntu.

            Установка и настройка агентов мониторинга.
            Итог: Оператор выполняет terraform apply и через 15-20 минут получает готовую к работе, воспроизводимую тестовую среду.

3. ДЕТАЛЬНАЯ АРХИТЕКТУРА КОМПОНЕНТОВ

Система построена по модульному принципу. Центральным оркестратором является Контроллер цикла, который через строго определенные API вызывает специализированные модули.

3.1. Контроллер цикла (Cycle Controller).

    Реализация: Микросервис на Python 3.11 с использованием FastAPI.

    Функции:

        Оркестрация: Последовательный вызов остальных модулей согласно workflow.

        Управление состоянием: Отслеживание текущего этапа, обработка ошибок, реализация простого finite-state machine.

        Управление стендом: Вызов Terraform/Ansible для инициализации, снапшотов и отката среды.

        Сбор артефактов: Агрегация выходных данных всех модулей (логи, конфиги, отчеты LLM).

        Формирование итога: Генерация финального доказательного отчета и его криптографическое подписание.

    API Endpoints (внутренние):

        POST /api/v1/lab/init -> Запуск развертывания лаборатории.

        POST /api/v1/attack/analyze -> Запуск модуля Attack Analyst.

        POST /api/v1/attack/execute -> Запуск модуля Attack Executor.

        POST /api/v1/remediation/generate -> Запуск модуля Remediation Synthesizer.

        POST /api/v1/remediation/apply -> Запуск модуля Remediation Applier.

        POST /api/v1/verify -> Запуск модуля верификации.

        GET /api/v1/report -> Получение итогового отчета.

3.2. Модуль Attack Analyst (Аналитик атаки).

    Назначение: Установить SSH-сессию к целевому коммутатору, собрать данные (show running-config, show vlan brief, show interfaces status), проанализировать их на предмет нарушения V-220668 и сформировать план проверки (Proof-of-Concept).

    Архитектура:

        Сборщик данных (Data Collector): Использует библиотеку Netmiko 4.2.0. Выполняет последовательность команд, сохраняет сырой вывод.

        Парсер (Parser): Использует TextFSM с шаблонами NTC Templates для преобразования текстового вывода CLI в структурированный JSON.
        Пример вывода парсера для show vlan brief:
        json

{
  "vlans": [
    {"vlan_id": "1", "name": "default", "status": "active", "ports": ["Gi2"]},
    {"vlan_id": "100", "name": "REMEDIATION_VLAN", "status": "active", "ports": []}
  ]
}

Аналитическое ядро (Analytics Core): Дообученная языковая модель Llama-3.1-8B-Instruct.

    Датасет для fine-tuning: 5000+ примеров вида:
    json

{
  "input": "Structured JSON data from parser (show run, show vlan). Reference: STIG V-220668.",
  "output": "{\"findings\": [{\"stig_id\": \"V-220668\", \"description\": \"Access port Gi2 is in default VLAN 1.\", \"severity\": \"medium\"}], \"attack_plan\": {\"goal\": \"Prove connectivity to target in VLAN 1.\", \"steps\": [{\"type\": \"connectivity_check\", \"tool\": \"ping\", \"target\": \"192.168.1.100\"}]}}"
}

Инференс: Используется фреймворк vLLM для высокой производительности. Промпт-шаблон:
text

Ты — эксперт по аудиту безопасности сетей. Проанализируй предоставленную конфигурацию коммутатора Cisco IOS.
Выяви нарушения стандарта DISA STIG. Сфокусируйся на V-220668.
Для каждого нарушения предложи простой PoC-план для демонстрации уязвимости.
Конфигурация: {structured_data_from_parser}

        Валидатор выхода: Полученный от LLM JSON проверяется на соответствие заранее заданной схеме (используется библиотека jsonschema). При несоответствии — ошибка, цикл останавливается.

3.3. Модуль Attack Executor (Исполнитель атаки).

    Назначение: Исполнить план, сгенерированный Attack Analyst, и зафиксировать факт успешной или неуспешной эксплуатации.

    Реализация: Python-скрипт, использующий Paramiko для подключения к "атакующему хосту" внутри EVE-NG и выполнения команд.

    Workflow:

        Получает на вход JSON-план от Attack Analyst.

        Устанавливает SSH-соединение с Attacker Host (Ubuntu VM).

        Интерпретирует план: для шага {"type": "connectivity_check", "tool": "ping", "target": "192.168.1.100"} выполняет команду ping -c 4 192.168.1.100.

        Перехватывает stdout/stderr команды, сохраняет в лог.

        Определяет успех: если ping показывает 0% packet loss, атака считается успешной.

        Формирует отчет: {"attack_successful": true, "evidence": "64 bytes from 192.168.1.100: icmp_seq=1 ttl=64 time=0.5 ms", "timestamp": "..."}.

3.4. Модуль Remediation Synthesizer (Синтезатор исправлений).

    Назначение: На основе отчета об успешной атаке и исходной конфигурации сгенерировать минимальный набор команд IOS для устранения уязвимости.

    Архитектура:

        Ядро синтеза (Synthesis Core): Дообученная языковая модель CodeLlama-13B-Instruct.

            Датасет для fine-tuning: 3000+ примеров вида:
            json

{
  "input": "Vulnerability: V-220668. Description: Access port Gi2 is in default VLAN 1. Current config snippet: 'interface Gi2\\n switchport access vlan 1'. Goal: Move port to a non-default VLAN (e.g., 100).",
  "output": "configure terminal\ninterface GigabitEthernet2\nswitchport access vlan 100\nend\nwrite memory"
}

Инференс: Используется Ollama (проще в развертывании для моделей до 13B). Промпт-шаблон:
text

Ты — эксперт по Cisco IOS. Сгенерируй минимальный набор команд для исправления уязвимости.
Уязвимость: {vulnerability_description}.
Контекст атаки: {attack_report}.
Текущая конфигурация интерфейса: {interface_config}.
Требование: Исправление должно быть идемпотентным и безопасным. Используй VLAN 100.
Выведи только команды, без пояснений.

        Синтаксический валидатор: Сгенерированные команды прогоняются через симулятор Cisco IOS (например, Cisco pyATS Genie в режиме config validation) или выполняются с флагом dry-run, если таковой поддерживается, для проверки на синтаксические ошибки.

3.5. Модуль Remediation Applier (Применитель исправлений).

    Назначение: Безопасно применить сгенерированный патч к целевому коммутатору.

    Реализация: Python-скрипт на основе Netmiko.

    Алгоритм "Безопасного применения":

        Бэкап: Перед внесением изменений выполняется show running-config и сохраняется в файл backup_pre_remediation.cfg.

        Применение: Команды передаются на устройство последовательно. После каждой потенциально опасной команды проверяется статус.

        Верификация налету: После применения патча сразу выполняется show running-config interface Gi2 для проверки, что switchport access vlan 1 изменился на switchport access vlan 100.

        Rollback-план: Заранее подготовлена последовательность команд для отката (из бэкапа). В случае ошибки на шаге 3 или по таймауту — rollback выполняется автоматически.

        Сохранение конфигурации: Если все проверки пройдены, выполняется write memory (или copy running-config startup-config).

3.6. Модуль Verification & Evidence (Верификация и доказательства).

    Назначение: Убедиться, что исправление эффективно, и сформировать криптографически верифицируемую цепочку доказательств всего цикла.

    Компоненты:

        Повторный тест (Re-Test): Модуль вызывает Attack Executor с точной копией исходного плана атаки. Ожидаемый результат — "attack_successful": false (пинг не проходит).

        Сборщик логов и метрик: Использует Vector 0.35.0 для сбора логов со всех компонентов (контроллера, модулей, syslog с CSR1000v) и отправки в Elasticsearch 8.11.

        Аналитический движок (в Elastic): Созданы правила Kibana Alerting:

            Правило ATTACK-SUCCESS: Срабатывает при появлении лога от Attack Executor с attack_successful: true.

            Правило REMEDIATION-APPLIED: Срабатывает при логе от Remediation Applier об успешном write memory.

            Правило VERIFICATION-PASS: Срабатывает, если после REMEDIATION-APPLIED в течение 5 минут НЕ сработало правило ATTACK-SUCCESS.

        Генератор доказательств (Evidence Generator):

            Собирает все ключевые артефакты цикла:

                Исходный backup_pre_remediation.cfg (хэш SHA-256).

                Отчет Attack Analyst (JSON).

                Отчет Attack Executor (JSON).

                Сгенерированный патч (текст).

                Лог применения патча.

                Отчет повторного теста (JSON).

                Триггеры правил Kibana.

            Строит Merkle Tree (библиотека merkletools), где листьями являются хэши каждого артефакта. Корень дерева (Merkle Root) — компактное представление целостности всего набора данных.

            Формирует финальный отчет в формате JSON-LD, включающий все артефакты, Merkle Root и цифровую подпись корня с использованием аппаратного токена YubiKey PIV (через библиотеку python-pkcs11).

4. ПОСЛЕДОВАТЕЛЬНОСТЬ РАБОТЫ (WORKFLOW) И ВЗАИМОДЕЙСТВИЕ КОМПОНЕНТОВ

Шаг 0: Подготовка (Manual). Оператор на хосте запускает команду: python zero1_controller.py --target-lab zero1-mvp --stig-id V-220668.

Шаг 1: Инициализация среды.

    Контроллер вызывает POST /api/v1/lab/init.

    Запускается Terraform, который разворачивает в EVE-NG чистую лабораторию.

    Запускается Ansible, который загружает уязвимую конфигурацию на CSR1000v и настраивает хосты.

    Контроллер ожидает готовности всех узлов (проверяет доступность по SSH).

    Создается снапшот виртуальной машины CSR1000v snapshot_pre_test. Фиксируется хэш снапшота (артефакт A1).

Шаг 2: Фаза анализа и атаки.

    Контроллер вызывает POST /api/v1/attack/analyze с параметрами (IP CSR, учетные данные).

    Модуль Attack Analyst выполняет сбор данных, анализ через LLM и возвращает план.

    Контроллер сохраняет отчет анализа (JSON). Фиксируется хэш отчета (артефакт A2).

    Контроллер вызывает POST /api/v1/attack/execute с полученным планом.

    Модуль Attack Executor выполняет план (ping). Возвращает отчет об успехе.

    Контроллер сохраняет отчет об атаке. Фиксируется хэш отчета (артефакт A3).

    В Elasticsearch срабатывает правило ATTACK-SUCCESS. Фиксируется факт срабатывания (артефакт A4).

Шаг 3: Фаза синтеза и применения исправления.

    Контроллер вызывает POST /api/v1/remediation/generate, передавая артефакты A2 и A3.

    Модуль Remediation Synthesizer генерирует патч. Контроллер сохраняет его. Фиксируется хэш патча (артефакт A5).

    Контроллер вызывает POST /api/v1/remediation/apply, передавая артефакт A5.

    Модуль Remediation Applier применяет патч, создает бэкап, проверяет результат, сохраняет конфигурацию.

    Контроллер сохраняет лог применения. Фиксируется хэш лога (артефакт A6).

    В Elasticsearch срабатывает правило REMEDIATION-APPLIED. Фиксируется факт срабатывания (артефакт A7).

Шаг 4: Фаза верификации.

    Контроллер вызывает POST /api/v1/verify.

    Модуль Verification запускает повторный тест, вызывая Attack Executor с тем же планом, что и в Шаге 2.

    Attack Executor выполняет ping, который должен завершиться неудачей (Destination Host Unreachable).

    Модуль Verification ожидает 5 минут. Правило ATTACK-SUCCESS НЕ срабатывает повторно.

    В Elasticsearch срабатывает правило VERIFICATION-PASS. Фиксируется факт срабатывания (артефакт A8).

    Контроллер сохраняет отчет повторного теста. Фиксируется хэш отчета (артефакт A9).

Шаг 5: Формирование доказательного пакета.

    Контроллер вызывает Evidence Generator, передавая список артефактов A1-A9.

    Генератор строит Merkle Tree, вычисляет Merkle Root MR1.

    Генератор запрашивает цифровую подпись для MR1 с помощью YubiKey. Получает подпись SIG1.

    Формируется итоговый документ ZERO1-Report-<timestamp>.json, содержащий:

        Метаданные (ID цикла, цель, временные метки).

        Ссылки на все артефакты (A1-A9) с их хэшами.

        Структуру Merkle Tree и значение MR1.

        Цифровую подпись SIG1 и сертификат с YubiKey.

        Итоговый вердикт: REMEDIATION_VERIFIED.

    Контроллер возвращает оператору путь к файлу отчета. Цикл завершен.

5. КРИТЕРИИ ПРИЕМКИ И МЕТРИКИ КАЧЕСТВА

5.1. Функциональные критерии (Functional Acceptance Criteria).

    F-AC1: Система должна развернуть тестовую среду (EVE-NG Lab с CSR1000v и двумя Ubuntu VM) одной командой без ручных вмешательств.

    F-AC2: Модуль Attack Analyst должен корректно идентифицировать наличие порта в VLAN 1 по результатам выполнения команд show vlan brief и show run interface Gi2.

    F-AC3: Модуль Attack Executor должен, получив план {"tool": "ping", "target": "192.168.1.100"}, успешно установить ICMP-сессию с целевым хостом и зафиксировать этот факт.

    F-AC4: Модуль Remediation Synthesizer должен, на основе факта успешной атаки, сгенерировать валидные команды Cisco IOS для перевода интерфейса Gi2 из VLAN 1 в VLAN 100.

    F-AC5: Модуль Remediation Applier должен применить сгенерированные команды, обеспечить их сохранение в startup-config и выполнить автоматический откат в случае ошибки.

    F-AC6: Модуль Verification должен после применения исправления запустить идентичную атаку и зафиксировать ее провал.

    F-AC7: Система должна сформировать итоговый отчет, содержащий криптографическую подпись, верифицируемую стандартными средствами (например, openssl dgst -verify).

5.2. Нефункциональные требования и метрики (Non-Functional Requirements).

    Производительность (Performance):

        NFR-P1: Время развертывания лаборатории (Шаг 1) ≤ 20 минут.

        NFR-P2: Время выполнения полного цикла (Шаги 2-5) ≤ 100 минут. Цель: 120 мин.

        NFR-P3: Инференс одной LLM (анализ или синтез) ≤ 3 минут.

    Надежность (Reliability):

        NFR-R1: Коэффициент успешного завершения цикла (Success Rate) за 10 запусков ≥ 90%.

        NFR-R2: Система должна корректно обрабатывать сетевые таймауты при подключении к CSR1000v и выполнять не более 3 повторных попыток.

    Точность (Accuracy):

        NFR-A1: Точность детектирования уязвимости V-220668 модулем Attack Analyst = 100% (ложноположительные срабатывания не допускаются).

        NFR-A2: Точность генерации синтаксически корректных команд IOS модулем Remediation Synthesizer ≥ 99%.

    Безопасность (Security):

        NFR-S1: Все учетные данные (пароли SSH, enable secret) хранятся в HashiCorp Vault. В коде и конфигах присутствуют только ссылки.

        NFR-S2: Цифровая подпись отчета должна создаваться с использованием приватного ключа на аппаратном токене (YubiKey). Приватный ключ никогда не покидает токен.


6. ПЛАН РЕАЛИЗАЦИИ (ROADMAP) И ПОРЯДОК ВЫПОЛНЕНИЯ РАБОТ

Общая длительность Phase 1 (MVP): 90 календарных дней. Работа ведется двумя параллельными потоками: Лаборатория и автоматизация и ML/LLM компоненты.
6.1. Поток A: Лаборатория, автоматизация и каркас системы (45 дней)
Спринт	Сроки	Ключевые задачи	Критерии завершения (Definition of Done)
Спринт A1	Дни 1-15	1. Базовая инфраструктура: Установка и настройка хоста (ESXi, Ubuntu), EVE-NG Pro, Docker.
2. Образы: Подготовка и импорт образов CSR1000v и Ubuntu в EVE-NG.
3. Сеть: Конфигурация изолированных сетей в EVE-NG (Management, Lab).	1. Из EVE-NG WebUI можно вручную запустить CSR1000v и Ubuntu VM, связать их сетью.
2. С хоста есть SSH-доступ к EVE-NG и к запущенным VM.
Спринт A2	Дни 16-30	1. Infrastructure as Code: Разработка Terraform-модулей для управления нодами EVE-NG через API/CLI.
2. Конфигурационный менеджмент: Создание Ansible-ролей для загрузки уязвимой конфигурации на CSR1000v и настройки Ubuntu (IP, ping, HTTP).
3. Базовый пайплайн: Написание Python-скрипта (lab_manager.py), который одной командой вызывает Terraform, затем Ansible.	1. Команда terraform apply в папке проекта создает полную топологию в EVE-NG.
2. Команда ansible-playbook deploy.yml настраивает все устройства.
3. Скрипт python lab_manager.py --deploy выполняет оба шага. Лаборатория готова к тесту.
Спринт A3	Дни 31-45	1. Каркас контроллера: Разработка FastAPI-приложения с эндпоинтами из раздела 3.1 (пока заглушки).
2. Модули Executor и Applier: Реализация классов для подключения по SSH (Paramiko/Netmiko), выполнения команд, парсинга вывода через TextFSM.
3. Мониторинг: Развертывание Elastic Stack в Docker, настройка приема syslog с CSR1000v, создание индексов в Kibana.	1. Запущен сервис zero1-controller. GET /api/v1/status возвращает {"status": "ready"}.
2. Существуют скрипты attack_executor.py и remediation_applier.py, которые могут выполнить ручной ping и применить заданный в коде патч.
3. В Kibana видны логи с коммутатора.
6.2. Поток B: ML/LLM компоненты и аналитика (45 дней)
Спринт	Сроки	Ключевые задачи	Критерии завершения (Definition of Done)
Спринт B1	Дни 1-22	1. Подготовка датасетов: Сбор и разметка данных для fine-tuning. Для Attack Analyst: пары (show run, show vlan) -> (finding JSON). Для Remediation Synthesizer: пары (finding, config snippet) -> (IOS commands).
2. Настройка ML-инфраструктуры: Установка CUDA, PyTorch, Hugging Face libraries, vLLM, Ollama на хост-сервер.
3. Базовый fine-tuning: Загрузка базовых моделей (Llama-3.1-8B, CodeLlama-13B) и их начальное дообучение на подготовленных датасетах.	1. Существуют два датасета в формате .jsonl объемом не менее 1000 примеров каждый.
2. Команды vLLM и ollama работают, могут загрузить базовую модель.
3. Процесс fine-tuning запускается и сохраняет адаптированные веса модели.
Спринт B2	Дни 23-37	1. Интеграция и тестирование моделей: Создание Python-классов-оберток для взаимодействия с vLLM/Ollama API.
2. Разработка промпт-инжиниринга: Точная настройка промпт-шаблонов для достижения стабильного и структурированного вывода.
3. Валидация вывода: Реализация jsonschema-валидаторов для выходных JSON моделей.	1. Класс LLMAnalyst может принять на вход текст show vlan и вернуть JSON с "stig_id": "V-220668".
2. Класс LLMRemediator по описанной уязвимости генерирует команды interface Gi2\n switchport access vlan 100.
3. Некорректный вывод моделей отлавливается валидатором, вызывается fallback-логика или ошибка.
Спринт B3	Дни 38-45	1. Интеграция с контроллером: Модификация заглушек в контроллере для вызова реальных ML-классов.
2. Создание модуля Evidence Generator: Реализация Merkle Tree, интеграция с YubiKey PIV для подписи.
3. Написание правил в Elastic: Создание правил Kibana Alerting для детектирования успеха атаки и применения патча.	1. Эндпоинт /api/v1/attack/analyze возвращает результат реального LLM-анализа.
2. Скрипт evidence.py формирует итоговый отчет с подписью.
3. В Kibana созданы и работают правила ATTACK-SUCCESS и REMEDIATION-APPLIED.
6.3. Фаза интеграции, отладки и приемочных испытаний (20 дней)

    Дни 46-65: Сведение двух потоков вместе. Сквозная отладка полного цикла, обработка edge-cases (ошибки сети, таймауты, некорректный вывод LLM). Настройка логирования всех этапов. Доводка производительности.

    Дни 66-90: Формальные приемочные испытания. Проведение 10 последовательных автономных запусков системы. Документирование результатов по всем критериям из раздела 5. Подготовка финальной демонстрации для стейкхолдеров.

7. ОЦЕНКА РИСКОВ И ПЛАН ИХ МИТИГАЦИИ
Категория риска	Конкретный риск	Вероятность	Влияние	Меры по смягчению (Mitigation)
Технологические	LLM выдает "галлюцинации": некорректный анализ или опасные команды.	Высокая	Критическое	1. Строгая валидация выхода по JSON-схеме. 2. Контрольные суммы и dry-run: Для команд на оборудовании использовать `show	verifyили выполнять вconfiguration commit confirmed` с автоматическим откатом. 3. Fallback-логика: При повторной ошибке LLM использовать хардкод-шаблон для конкретной уязвимости V-220668.
	Нестабильность сетевой эмуляции (EVE-NG/CSR1000v).	Средняя	Высокое	1. Детектирование и перезапуск: Контроллер должен мониторить доступность нод по SSH. При недоступности CSR1000v более 2 минут — перезапускать лабораторию с нуля. 2. Использование снапшотов: Перед каждым тестом восстанавливаться с чистого снапшота, а не переконфигурировать "грязную" систему.
Операционные	Сложность воспроизведения среды (проблемы с лицензиями образов, версиями ПО).	Средняя	Высокое	1. Полная контейнеризация всех компонентов, кроме EVE-NG и гипервизора. Использование Dockerfile и docker-compose.yml. 2. Детальная документация по версиям и процессу лицензирования CSR1000v. 3. Резервное копирование готовых образов ВМ.
	Недостаточная производительность инференса LLM на имеющемся GPU.	Средняя	Среднее	1. Оптимизация моделей: Использование квантизации (4-bit, GPTQ) для ускорения инференса с минимальной потерей качества. 2. Использование более мелких моделей: Для MVP можно рассмотреть Llama-3.2-3B и CodeLlama-7B. 3. Кэширование промптов.
Проектные	Срыв сроков из-за сложности интеграции компонентов.	Высокая	Высокое	1. Четкое модульное тестирование. Каждый модуль (Analyst, Executor и т.д.) должен иметь набор юнит- и интеграционных тестов. 2. Недельные стендапы двух потоков (A и B) для синхронизации API. 3. Приоритизация: В первую очередь реализовать "костяк" с хардкод-логикой, затем интегрировать LLM.
8. ТРЕБОВАНИЯ К КОМАНДЕ, РОЛИ И ОЦЕНКА БЮДЖЕТА

8.1. Команда на Phase 1 (MVP):

    Ведущий инженер (Tech Lead) / Архитектор (1 чел.): Общая архитектура, протоколы взаимодействия, интеграция. Знания: Python, сетевые протоколы, DevOps, основы ML.

    Инженер DevOps / Сетевой инженер (1 чел.): Развертывание и автоматизация EVE-NG, работа с Terraform/Ansible, настройка сетей, CSR1000v. Знания: Cisco IOS, EVE-NG, IaC, Linux.

    ML/LLM инженер (1 чел.): Подготовка датасетов, fine-tuning моделей, оптимизация инференса, промпт-инжиниринг. Знания: PyTorch, Hugging Face, vLLM, работа с LLM.

    Инженер по безопасности / Разработчик (1 чел., part-time): Реализация модулей безопасного применения, работа с криптографией (Merkle Tree, YubiKey), настройка Elastic Stack и правил детектирования.

8.2. Оценка бюджета на Phase 1 (90 дней):

    Оборудование (CAPEX, разово):

        Сервер (с GPU) или аренда в облаке с инстансом типа g5.48xlarge (AWS) / NC96ads_A100_v4 (Azure): ~1 800 000 руб. (ориентировочно).

        Аппаратные токены YubiKey PIV (2 шт.): ~15 000 руб.

    Лицензионное ПО:

        EVE-NG Professional лицензия: ~60 000 руб.

        Образ Cisco CSR1000v (или использование VIRL/CML подписки): ~150 000 руб.

    Фонд оплаты труда (OPEX, 90 дней):

        ИТ-специалисты (3.5 ставки), средняя стоимость: ~2 500 000 руб.

Итого ориентировочный бюджет Phase 1: ~4 525 000 руб.
9. ЗАКЛЮЧЕНИЕ И СЛЕДУЮЩИЕ ШАГИ

Project ZERO-1 представляет собой сфокусированный, технически насыщенный прототип, призванный доказать принципиальную возможность автоматизации одного из самых трудоемких процессов в кибербезопасности — проверки и исправления конфигураций сетевого оборудования.

Ключевой результат успешной реализации MVP: Не отчет или презентация, а работающая система, которая по одной команде выполняет полный цикл и выдает криптографически верифицируемый артефакт, доказывающий, что конкретная уязвимость была найдена, доказана и устранена. Этот артефакт является основой для перехода к следующим этапам.

Roadmap после успешного MVP (Phase 1.5 и Phase 2):

    Phase 1.5 (Расширение покрытия, +4 месяца):

        Добавление поддержки 5-7 новых проверок DISA STIG для Cisco IOS (отключение служб, ACL, парольная политика).

        Интеграция с MITRE D3FEND для улучшения качества генерируемых контрмер.

        Создание простого Web-интерфейса для управления циклами и просмотра отчетов.

    Phase 2.0 (Коэволюция и продуктивизация, +6 месяцев):

        Преобразование линейного конвейера в петлю коэволюции: два экземпляра LLM (атакующий и защищающий) соревнуются в адаптивных раундах, где каждый следующий шаг атаки строится с учетом предыдущих защит.

        Поддержка другого вендора сетевого оборудования (Juniper JunOS).

        Упаковка решения в форму SaaS-сервиса или on-premise аппаратного комплекса ("коробка") для поставки заказчикам.

Настоящий документ является исчерпывающим техническим заданием для начала работ над Phase 1 (MVP).
ПРИЛОЖЕНИЯ (APPENDIX)

Appendix A: Глоссарий терминов.

    STIG (Security Technical Implementation Guide): Документ с требованиями по безопасности для конкретного ПО или устройства.

    IaC (Infrastructure as Code): Практика управления инфраструктурой с помощью конфигурационных файлов.

    LLM (Large Language Model): Большая языковая модель, основанная на архитектуре трансформеров.

    Fine-tuning: Процесс дополнительного обучения предварительно обученной модели на узкоспециализированном наборе данных.

    Инференс (Inference): Процесс получения вывода от модели на новых данных.

    Merkle Tree: Криптографическая структура данных для эффективной проверки целостности большого набора данных.

    PIV (Personal Identity Verification): Стандарт для смарт-карт и аппаратных токенов, используемый для хранения криптографических ключей.

Appendix B: Ссылки на ключевые технологии и репозитории.

    EVE-NG: https://www.eve-ng.net/

    Cisco CSR1000v: https://developer.cisco.com/docs/csr1000v-getting-started/

    DISA STIG Viewer: https://public.cyber.mil/stigs/

    Llama 3.2: https://llama.meta.com/llama3/

    CodeLlama: https://ai.meta.com/blog/code-llama-large-language-model-coding/

    vLLM: https://github.com/vllm-project/vllm

    Ollama: https://ollama.ai/

    Netmiko: https://github.com/ktbyers/netmiko

    Elastic Stack: https://www.elastic.co/

Appendix C: Форматы ключевых JSON-сообщений (схемы).
(Пример схемы для отчета Attack Analyst)
json

{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Attack Analyst Report",
  "type": "object",
  "required": ["findings", "attack_plan"],
  "properties": {
    "findings": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["stig_id", "description", "severity"],
        "properties": {
          "stig_id": {"type": "string", "pattern": "^V-\\d+$"},
          "description": {"type": "string"},
          "severity": {"type": "string", "enum": ["high", "medium", "low"]}
        }
      }
    },
    "attack_plan": {
      "type": "object",
      "required": ["goal", "steps"],
      "properties": {
        "goal": {"type": "string"},
        "steps": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["type", "tool", "target"],
            "properties": {
              "type": {"type": "string"},
              "tool": {"type": "string"},
              "target": {"type": "string", "format": "ipv4"}
            }
          }
        }
      }
    }
  }
}
