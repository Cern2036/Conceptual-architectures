Appendix H: –î–µ—Ç–∞–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
H.1. –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è (deploy.sh)
bash

#!/bin/bash
set -e

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
export PROJECT_NAME="zero1"
export ENVIRONMENT="${1:-staging}"
export COMPOSE_PROFILES="${2:-all}"

# –í–∞–ª–∏–¥–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è
validate_environment() {
    echo "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è..."
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
    required_vars=("DB_PASSWORD" "MINIO_ROOT_PASSWORD" "GRAFANA_PASSWORD")
    for var in "${required_vars[@]}"; do
        if [ -z "${!var}" ]; then
            echo "‚ùå –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è $var –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞"
            exit 1
        fi
    done
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ Docker
    if ! command -v docker &> /dev/null; then
        echo "‚ùå Docker –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"
        exit 1
    fi
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ Docker Compose
    if ! docker compose version &> /dev/null; then
        echo "‚ùå Docker Compose –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"
        exit 1
    fi
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ NVIDIA Docker (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è)
    if [[ "$COMPOSE_PROFILES" == *"gpu"* ]]; then
        if ! docker run --rm --gpus all nvidia/cuda:12.1.0-base nvidia-smi &> /dev/null; then
            echo "‚ùå NVIDIA Docker –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω"
            exit 1
        fi
    fi
    
    echo "‚úÖ –û–∫—Ä—É–∂–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ"
}

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
init_infrastructure() {
    echo "üèóÔ∏è  –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã..."
    
    # –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ç–µ–π Docker
    docker network create ${PROJECT_NAME}-backend 2>/dev/null || true
    docker network create ${PROJECT_NAME}-monitoring 2>/dev/null || true
    
    # –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –¥–ª—è –¥–∞–Ω–Ω—ã—Ö
    mkdir -p ./data/{postgres,minio,elasticsearch,prometheus,grafana}
    
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
    chown -R 1000:1000 ./data/postgres
    chown -R 1000:1000 ./data/minio
    chown -R 1000:1000 ./data/elasticsearch
    
    echo "‚úÖ –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≥–æ—Ç–æ–≤–∞"
}

# –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
deploy_base_services() {
    echo "üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤..."
    
    # –ó–∞–ø—É—Å–∫ –±–∞–∑–æ–≤–æ–≥–æ —Å—Ç–µ–∫–∞
    docker compose --profile base up -d \
        postgres \
        minio \
        elasticsearch \
        kibana
    
    # –û–∂–∏–¥–∞–Ω–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–æ–≤
    wait_for_service "PostgreSQL" "pg_isready -U zero1" 60
    wait_for_service "MinIO" "curl -f http://localhost:9000/minio/health/live" 30
    wait_for_service "Elasticsearch" "curl -f http://localhost:9200/_cluster/health" 45
    
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö
    echo "üì¶ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö..."
    docker compose exec -T postgres psql -U zero1 -d zero1 < ./sql/init_schema.sql
    docker compose exec -T postgres psql -U zero1 -d zero1 < ./sql/seed_data.sql
    
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ MinIO
    echo "ü™£ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ MinIO..."
    docker compose run --rm mc mb minio/zero1-artifacts
    docker compose run --rm mc anonymous set download minio/zero1-artifacts
    
    echo "‚úÖ –ë–∞–∑–æ–≤—ã–µ —Å–µ—Ä–≤–∏—Å—ã –∑–∞–ø—É—â–µ–Ω—ã"
}

# –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ ML-—Å–µ—Ä–≤–∏—Å–æ–≤
deploy_ml_services() {
    echo "üß† –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ ML-—Å–µ—Ä–≤–∏—Å–æ–≤..."
    
    # –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–µ–π (–µ—Å–ª–∏ –Ω–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã—Ö –∫–æ–ø–∏–π)
    if [ ! -f "./models/llama-3.1-8b-ft.tar.gz" ]; then
        echo "‚¨áÔ∏è  –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–µ–π..."
        wget -O ./models/llama-3.1-8b-ft.tar.gz \
            https://storage.example.com/models/llama-3.1-8b-ft.tar.gz
        tar -xzf ./models/llama-3.1-8b-ft.tar.gz -C ./models/
    fi
    
    # –ó–∞–ø—É—Å–∫ ML-—Å–µ—Ä–≤–∏—Å–æ–≤
    docker compose --profile ml up -d \
        ml-service \
        ml-cache
    
    # –û–∂–∏–¥–∞–Ω–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
    wait_for_service "ML Service" "curl -f http://localhost:8080/health" 120
    
    echo "‚úÖ ML-—Å–µ—Ä–≤–∏—Å—ã –∑–∞–ø—É—â–µ–Ω—ã"
}

# –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
deploy_app_services() {
    echo "‚öôÔ∏è  –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è..."
    
    # –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    docker compose --profile app up -d \
        zero1-controller \
        verifier \
        scheduler \
        worker
    
    # –û–∂–∏–¥–∞–Ω–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
    wait_for_service "Controller" "curl -f http://localhost:8000/api/v1/health" 30
    wait_for_service "Verifier" "curl -f http://localhost:8081/health" 30
    
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ –∑–∞–¥–∞—á
    echo "‚è∞ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞..."
    docker compose exec scheduler python init_scheduler.py
    
    echo "‚úÖ –°–µ—Ä–≤–∏—Å—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∑–∞–ø—É—â–µ–Ω—ã"
}

# –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
deploy_monitoring() {
    echo "üìä –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞..."
    
    # –ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
    docker compose --profile monitoring up -d \
        prometheus \
        grafana \
        node-exporter \
        cadvisor
    
    # –û–∂–∏–¥–∞–Ω–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
    wait_for_service "Prometheus" "curl -f http://localhost:9090/-/healthy" 30
    wait_for_service "Grafana" "curl -f http://localhost:3000/api/health" 45
    
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Grafana
    echo "‚öôÔ∏è  –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Grafana..."
    docker compose exec grafana grafana-cli admin reset-admin-password $GRAFANA_PASSWORD
    
    # –ò–º–ø–æ—Ä—Ç –¥–∞—à–±–æ—Ä–¥–æ–≤
    curl -X POST \
        -H "Content-Type: application/json" \
        -H "Accept: application/json" \
        -d @./monitoring/dashboards/zero1-overview.json \
        http://admin:$GRAFANA_PASSWORD@localhost:3000/api/dashboards/db
    
    echo "‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–∞–ø—É—â–µ–Ω"
}

# –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ–∂–∏–¥–∞–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞
wait_for_service() {
    local service_name=$1
    local check_command=$2
    local timeout=$3
    local start_time=$(date +%s)
    
    echo -n "‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ $service_name..."
    
    while true; do
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∞–π–º–∞—É—Ç–∞
        local current_time=$(date +%s)
        local elapsed=$((current_time - start_time))
        
        if [ $elapsed -ge $timeout ]; then
            echo "‚ùå"
            echo "–¢–∞–π–º–∞—É—Ç –æ–∂–∏–¥–∞–Ω–∏—è $service_name"
            exit 1
        fi
        
        # –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
        if eval "$check_command" &> /dev/null; then
            echo "‚úÖ"
            return 0
        fi
        
        sleep 2
        echo -n "."
    done
}

# –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞
main() {
    echo "üöÄ –ó–∞–ø—É—Å–∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è Project ZERO-1"
    echo "üìå –û–∫—Ä—É–∂–µ–Ω–∏–µ: $ENVIRONMENT"
    echo "üìå –ü—Ä–æ—Ñ–∏–ª–∏: $COMPOSE_PROFILES"
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π
    if [ "$EUID" -ne 0 ]; then
        echo "‚ö†Ô∏è  –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—â–µ–Ω –±–µ–∑ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π root"
        read -p "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å? (y/N): " -n 1 -r
        echo
        if [[ ! $REPLY =~ ^[Yy]$ ]]; then
            exit 1
        fi
    fi
    
    # –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —ç—Ç–∞–ø–æ–≤ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
    validate_environment
    init_infrastructure
    
    case "$COMPOSE_PROFILES" in
        "all")
            deploy_base_services
            deploy_ml_services
            deploy_app_services
            deploy_monitoring
            ;;
        "base")
            deploy_base_services
            ;;
        "ml")
            deploy_ml_services
            ;;
        "app")
            deploy_app_services
            ;;
        "monitoring")
            deploy_monitoring
            ;;
        *)
            echo "‚ùå –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å: $COMPOSE_PROFILES"
            exit 1
            ;;
    esac
    
    # –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
    echo "üîç –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã..."
    sleep 10
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
    services=$(docker compose ps --services)
    for service in $services; do
        if [ "$(docker compose ps -q $service)" ]; then
            status=$(docker compose ps --format json | jq -r ".[] | select(.Service==\"$service\") | .Status")
            echo "  $service: $status"
        else
            echo "  ‚ùå $service: –ù–ï –ó–ê–ü–£–©–ï–ù"
        fi
    done
    
    echo ""
    echo "üéâ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!"
    echo ""
    echo "üåê –î–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–∏—Å–∞–º:"
    echo "  ‚Ä¢ –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä API: http://localhost:8000/docs"
    echo "  ‚Ä¢ MinIO Console: http://localhost:9001"
    echo "  ‚Ä¢ Kibana: http://localhost:5601"
    echo "  ‚Ä¢ Grafana: http://localhost:3000"
    echo "  ‚Ä¢ Prometheus: http://localhost:9090"
    echo ""
    echo "üîë –£—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Ñ–∞–π–ª–µ .env"
}

# –ó–∞–ø—É—Å–∫ –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
main "$@"

H.2. –°–∫—Ä–∏–ø—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–æ–π (manage-system.sh)
bash

#!/bin/bash

COMMAND="${1:-help}"
SERVICE="${2:-all}"

case $COMMAND in
    start)
        echo "‚ñ∂Ô∏è  –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã..."
        docker compose start $SERVICE
        ;;
        
    stop)
        echo "‚è∏Ô∏è  –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã..."
        docker compose stop $SERVICE
        ;;
        
    restart)
        echo "üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã..."
        docker compose restart $SERVICE
        ;;
        
    status)
        echo "üìä –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã:"
        docker compose ps
        
        echo ""
        echo "üìà –ú–µ—Ç—Ä–∏–∫–∏:"
        docker stats --no-stream --format "table {{.Name}}\t{{.CPUPerc}}\t{{.MemUsage}}\t{{.NetIO}}" | head -10
        ;;
        
    logs)
        echo "üìã –õ–æ–≥–∏ —Å–∏—Å—Ç–µ–º—ã:"
        docker compose logs --tail=100 -f $SERVICE
        ;;
        
    backup)
        echo "üíæ –°–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–∞..."
        TIMESTAMP=$(date +%Y%m%d_%H%M%S)
        BACKUP_DIR="./backups/backup_$TIMESTAMP"
        
        mkdir -p $BACKUP_DIR
        
        # –ë—ç–∫–∞–ø –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö
        docker compose exec -T postgres pg_dump -U zero1 zero1 > $BACKUP_DIR/database.sql
        docker compose exec -T postgres pg_dump -U zero1 --schema-only zero1 > $BACKUP_DIR/schema.sql
        
        # –ë—ç–∫–∞–ø –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
        cp -r ./config $BACKUP_DIR/
        cp .env $BACKUP_DIR/
        
        # –ë—ç–∫–∞–ø Docker volumes
        docker run --rm \
            -v ${PROJECT_NAME}_postgres_data:/source:ro \
            -v $(pwd)/$BACKUP_DIR:/backup \
            alpine tar czf /backup/postgres_data.tar.gz -C /source .
        
        # –°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞
        tar czf ./backups/system_backup_$TIMESTAMP.tar.gz -C ./backups backup_$TIMESTAMP
        
        echo "‚úÖ –ë—ç–∫–∞–ø —Å–æ–∑–¥–∞–Ω: backups/system_backup_$TIMESTAMP.tar.gz"
        ;;
        
    update)
        echo "üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã..."
        
        # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–∑–æ–≤
        docker compose pull
        
        # –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã
        docker compose down
        
        # –ó–∞–ø—É—Å–∫ —Å –Ω–æ–≤—ã–º–∏ –æ–±—Ä–∞–∑–∞–º–∏
        docker compose up -d
        
        # –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
        docker compose exec -T postgres psql -U zero1 -d zero1 < ./sql/migrations/latest.sql
        
        echo "‚úÖ –°–∏—Å—Ç–µ–º–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞"
        ;;
        
    cleanup)
        echo "üßπ –û—á–∏—Å—Ç–∫–∞ —Å–∏—Å—Ç–µ–º—ã..."
        
        read -p "–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ —É–¥–∞–ª–∏—Ç—å –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã? (y/N): " -n 1 -r
        echo
        if [[ $REPLY =~ ^[Yy]$ ]]; then
            docker compose down -v
            docker system prune -af
            echo "‚úÖ –°–∏—Å—Ç–µ–º–∞ –æ—á–∏—â–µ–Ω–∞"
        fi
        ;;
        
    test-cycle)
        echo "üß™ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ü–∏–∫–ª–∞..."
        
        CYCLE_ID=$(uuidgen)
        
        # –ó–∞–ø—É—Å–∫ —Ü–∏–∫–ª–∞ —á–µ—Ä–µ–∑ API
        curl -X POST \
            -H "Content-Type: application/json" \
            -d "{\"cycle_id\": \"$CYCLE_ID\", \"target\": \"csr1000v-test\", \"stig_id\": \"V-220668\"}" \
            http://localhost:8000/api/v1/cycle/start
            
        echo "‚úÖ –¶–∏–∫–ª –∑–∞–ø—É—â–µ–Ω: $CYCLE_ID"
        
        # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
        while true; do
            STATUS=$(curl -s http://localhost:8000/api/v1/cycle/$CYCLE_ID/status | jq -r '.status')
            echo "–°—Ç–∞—Ç—É—Å: $STATUS"
            
            if [[ "$STATUS" == "completed" ]] || [[ "$STATUS" == "failed" ]]; then
                break
            fi
            
            sleep 10
        done
        
        # –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
        curl -s http://localhost:8000/api/v1/cycle/$CYCLE_ID/report | jq .
        ;;
        
    *)
        echo "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: $0 {start|stop|restart|status|logs|backup|update|cleanup|test-cycle} [service]"
        echo ""
        echo "–ö–æ–º–∞–Ω–¥—ã:"
        echo "  start       - –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã –∏–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞"
        echo "  stop        - –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã –∏–ª–∏ —Å–µ—Ä–≤–∏—Å–∞"
        echo "  restart     - –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã –∏–ª–∏ —Å–µ—Ä–≤–∏—Å–∞"
        echo "  status      - –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã –∏ –º–µ—Ç—Ä–∏–∫–∏"
        echo "  logs        - –ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏ —Å–∏—Å—Ç–µ–º—ã –∏–ª–∏ —Å–µ—Ä–≤–∏—Å–∞"
        echo "  backup      - –°–æ–∑–¥–∞—Ç—å –ø–æ–ª–Ω—ã–π –±—ç–∫–∞–ø —Å–∏—Å—Ç–µ–º—ã"
        echo "  update      - –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –æ–±—Ä–∞–∑—ã –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å"
        echo "  cleanup     - –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∏ –æ–±—Ä–∞–∑—ã"
        echo "  test-cycle  - –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Ü–∏–∫–ª"
        ;;
esac

H.3. –°–∫—Ä–∏–ø—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –∞–ª–µ—Ä—Ç–∏–Ω–≥–∞ (monitor.sh)
bash

#!/bin/bash

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
ALERT_THRESHOLDS=(
    "cpu_usage:80"
    "memory_usage:85"
    "disk_usage:90"
    "container_restarts:5"
    "api_latency_ms:5000"
    "error_rate:5"
)

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Ç—Ä–∏–∫
check_metrics() {
    echo "üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Ç—Ä–∏–∫ —Å–∏—Å—Ç–µ–º—ã..."
    
    # CPU Usage
    CPU_USAGE=$(docker stats --no-stream --format "{{.CPUPerc}}" | sed 's/%//' | awk '{sum+=$1} END {print sum/NR}')
    if (( $(echo "$CPU_USAGE > 80" | bc -l) )); then
        send_alert "high_cpu" "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CPU: ${CPU_USAGE}%"
    fi
    
    # Memory Usage
    MEM_USAGE=$(docker stats --no-stream --format "{{.MemUsage}}" | awk '{print $1}' | sed 's/%//' | awk '{sum+=$1} END {print sum/NR}')
    if (( $(echo "$MEM_USAGE > 85" | bc -l) )); then
        send_alert "high_memory" "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏: ${MEM_USAGE}%"
    fi
    
    # Container Health
    UNHEALTHY=$(docker ps --filter "health=unhealthy" --format "{{.Names}}" | wc -l)
    if [ $UNHEALTHY -gt 0 ]; then
        send_alert "unhealthy_containers" "–ù–µ–∏—Å–ø—Ä–∞–≤–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã: $UNHEALTHY"
    fi
    
    # API Latency
    API_LATENCY=$(curl -o /dev/null -s -w '%{time_total}\n' http://localhost:8000/api/v1/health)
    if (( $(echo "$API_LATENCY > 5" | bc -l) )); then
        send_alert "high_latency" "–ó–∞–¥–µ—Ä–∂–∫–∞ API: ${API_LATENCY}—Å"
    fi
    
    # Database Connections
    DB_CONNS=$(docker compose exec -T postgres psql -U zero1 -t -c "SELECT count(*) FROM pg_stat_activity WHERE state = 'active';")
    if [ $DB_CONNS -gt 50 ]; then
        send_alert "high_db_connections" "–ê–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∫ –ë–î: $DB_CONNS"
    fi
}

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
check_data_integrity() {
    echo "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö..."
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ö—ç—à–µ–π –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤
    INTEGRITY_ERRORS=0
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 10 —Ü–∏–∫–ª–æ–≤
    CYCLES=$(docker compose exec -T postgres psql -U zero1 -t -c "SELECT cycle_id FROM test_cycles ORDER BY created_at DESC LIMIT 10;")
    
    for CYCLE in $CYCLES; do
        CYCLE=$(echo $CYCLE | xargs)
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ Merkle Root
        EXPECTED_ROOT=$(docker compose exec -T postgres psql -U zero1 -t -c "SELECT merkle_root FROM test_cycles WHERE cycle_id = '$CYCLE';" | xargs)
        
        if [ -n "$EXPECTED_ROOT" ]; then
            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ —Ü–∏–∫–ª–∞
            ARTIFACTS=$(docker compose exec -T postgres psql -U zero1 -t -c "SELECT storage_path, sha256_hash FROM artifacts_registry WHERE cycle_id = '$CYCLE';")
            
            while IFS='|' read -r PATH HASH; do
                PATH=$(echo $PATH | xargs)
                HASH=$(echo $HASH | xargs)
                
                # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ö—ç—à–∞ —Ñ–∞–π–ª–∞ –≤ MinIO
                ACTUAL_HASH=$(docker compose run --rm mc cat minio/zero1-artifacts/$PATH | sha256sum | awk '{print $1}')
                
                if [ "$ACTUAL_HASH" != "$HASH" ]; then
                    echo "‚ùå –ù–∞—Ä—É—à–µ–Ω–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å: $PATH"
                    ((INTEGRITY_ERRORS++))
                fi
            done <<< "$ARTIFACTS"
        fi
    done
    
    if [ $INTEGRITY_ERRORS -gt 0 ]; then
        send_alert "data_integrity" "–û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –æ—à–∏–±–∫–∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏: $INTEGRITY_ERRORS"
    fi
}

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
check_security() {
    echo "üîí –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏..."
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
    SECURITY_UPDATES=$(docker scout cves $(docker images -q) | grep -c "CRITICAL\|HIGH")
    
    if [ $SECURITY_UPDATES -gt 0 ]; then
        send_alert "security_updates" "–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: $SECURITY_UPDATES"
    fi
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ—Ä—Ç–æ–≤
    OPEN_PORTS=$(ss -tuln | grep -E ':(8000|9000|9001|5601|3000|9090)' | wc -l)
    if [ $OPEN_PORTS -gt 6 ]; then
        send_alert "open_ports" "–û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã"
    fi
}

# –û—Ç–ø—Ä–∞–≤–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤
send_alert() {
    local alert_type=$1
    local message=$2
    local timestamp=$(date +"%Y-%m-%d %H:%M:%S")
    
    echo "[$timestamp] üö® $message"
    
    # –ó–∞–ø–∏—Å—å –≤ –ª–æ–≥
    echo "[$timestamp] $alert_type: $message" >> /var/log/zero1/alerts.log
    
    # –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Slack (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ)
    if [ -n "$SLACK_WEBHOOK" ]; then
        curl -X POST \
            -H 'Content-type: application/json' \
            --data "{\"text\":\"üö® Project ZERO-1 Alert: $message\"}" \
            $SLACK_WEBHOOK > /dev/null 2>&1
    fi
    
    # –û—Ç–ø—Ä–∞–≤–∫–∞ email (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ)
    if [ -n "$ALERT_EMAIL" ]; then
        echo "Alert: $message" | mail -s "[ZERO1] $alert_type Alert" $ALERT_EMAIL
    fi
}

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–æ–≤
generate_report() {
    echo "üìÑ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞..."
    
    REPORT_DATE=$(date +%Y-%m-%d)
    REPORT_FILE="/var/log/zero1/reports/daily_$REPORT_DATE.md"
    
    cat > $REPORT_FILE << EOF
# –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –æ—Ç—á–µ—Ç Project ZERO-1
## –î–∞—Ç–∞: $REPORT_DATE

### üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã
- **–í—Å–µ–≥–æ —Ü–∏–∫–ª–æ–≤:** $(docker compose exec -T postgres psql -U zero1 -t -c "SELECT count(*) FROM test_cycles;")
- **–£—Å–ø–µ—à–Ω—ã—Ö —Ü–∏–∫–ª–æ–≤:** $(docker compose exec -T postgres psql -U zero1 -t -c "SELECT count(*) FROM test_cycles WHERE overall_status = 'completed';")
- **–ù–µ—É–¥–∞—á–Ω—ã—Ö —Ü–∏–∫–ª–æ–≤:** $(docker compose exec -T postgres psql -U zero1 -t -c "SELECT count(*) FROM test_cycles WHERE overall_status = 'failed';")
- **–ê–∫—Ç–∏–≤–Ω—ã—Ö —Ü–∏–∫–ª–æ–≤:** $(docker compose exec -T postgres psql -U zero1 -t -c "SELECT count(*) FROM test_cycles WHERE overall_status = 'running';")

### ‚ö†Ô∏è  –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ—à–∏–±–∫–∏
$(docker compose exec -T postgres psql -U zero1 -t -c "SELECT error_message, created_at FROM cycle_stages WHERE status = 'failed' ORDER BY created_at DESC LIMIT 5;" | sed 's/|/ | /g')

### üíæ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
- **CPU:** ${CPU_USAGE}%
- **–ü–∞–º—è—Ç—å:** ${MEM_USAGE}%
- **–î–∏—Å–∫:** $(df -h / | awk 'NR==2 {print $5}')
- **–°–µ—Ç—å:** $(docker stats --no-stream --format "{{.NetIO}}" | head -1)

### üîç –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
EOF
    
    # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–µ—Ç—Ä–∏–∫
    if (( $(echo "$CPU_USAGE > 70" | bc -l) )); then
        echo "- ‚ö†Ô∏è  –í—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ CPU. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ" >> $REPORT_FILE
    fi
    
    if [ $UNHEALTHY -gt 0 ]; then
        echo "- ‚ö†Ô∏è  –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã. –¢—Ä–µ–±—É–µ—Ç—Å—è –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–æ" >> $REPORT_FILE
    fi
    
    echo "" >> $REPORT_FILE
    echo "*–û—Ç—á–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏*" >> $REPORT_FILE
}

# –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
main() {
    echo "üîç –ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ Project ZERO-1"
    echo "‚è∞ –í—Ä–µ–º—è: $(date)"
    
    # –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –¥–ª—è –ª–æ–≥–æ–≤
    mkdir -p /var/log/zero1/{alerts,reports}
    
    # –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–æ–∫
    check_metrics
    check_data_integrity
    check_security
    generate_report
    
    echo "‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–∞–≤–µ—Ä—à–µ–Ω"
    echo "üìÅ –û—Ç—á–µ—Ç: /var/log/zero1/reports/daily_$(date +%Y-%m-%d).md"
}

# –ó–∞–ø—É—Å–∫ —Å cron –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
if [ "$1" = "cron" ]; then
    main >> /var/log/zero1/monitoring.log 2>&1
else
    main
fi

H.4. –§–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Prometheus (prometheus.yml)
yaml

global:
  scrape_interval: 15s
  evaluation_interval: 15s

alerting:
  alertmanagers:
    - static_configs:
        - targets:
          - alertmanager:9093

rule_files:
  - "alerts/*.yml"

scrape_configs:
  # Node Exporter
  - job_name: 'node'
    static_configs:
      - targets: ['node-exporter:9100']
    metrics_path: /metrics

  # Docker
  - job_name: 'cadvisor'
    static_configs:
      - targets: ['cadvisor:8080']
    metrics_path: /metrics

  # PostgreSQL
  - job_name: 'postgres'
    static_configs:
      - targets: ['postgres-exporter:9187']
    metrics_path: /metrics

  # –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
  - job_name: 'zero1-app'
    static_configs:
      - targets:
        - 'zero1-controller:8000'
        - 'ml-service:8080'
        - 'verifier:8081'
    metrics_path: /metrics
    scrape_interval: 30s

  # Blackbox exporter
  - job_name: 'blackbox'
    metrics_path: /probe
    params:
      module: [http_2xx]
    static_configs:
      - targets:
        - http://zero1-controller:8000/health
        - http://ml-service:8080/health
        - http://minio:9000/minio/health/live
    relabel_configs:
      - source_labels: [__address__]
        target_label: __param_target
      - source_labels: [__param_target]
        target_label: instance
      - target_label: __address__
        replacement: blackbox-exporter:9115

H.5. –ü—Ä–∞–≤–∏–ª–∞ –∞–ª–µ—Ä—Ç–∏–Ω–≥–∞ Prometheus (alerts/zero1-alerts.yml)
yaml

groups:
  - name: zero1
    rules:
      # –ê–ª–µ—Ä—Ç—ã –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
      - alert: HighCPUUsage
        expr: 100 - (avg by(instance) (rate(node_cpu_seconds_total{mode="idle"}[5m])) * 100) > 80
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "–í—ã—Å–æ–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ CPU –Ω–∞ {{ $labels.instance }}"
          description: "CPU usage is {{ $value }}%"

      - alert: HighMemoryUsage
        expr: (1 - node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes) * 100 > 85
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "–í—ã—Å–æ–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø–∞–º—è—Ç–∏ –Ω–∞ {{ $labels.instance }}"
          description: "Memory usage is {{ $value }}%"

      # –ê–ª–µ—Ä—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
      - alert: HighAPILatency
        expr: histogram_quantile(0.95, rate(http_request_duration_seconds_bucket{job="zero1-app"}[5m])) > 5
        for: 2m
        labels:
          severity: warning
        annotations:
          summary: "–í—ã—Å–æ–∫–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ API"
          description: "95-–π –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª—å –∑–∞–¥–µ—Ä–∂–∫–∏ {{ $value }}s"

      - alert: HighErrorRate
        expr: rate(http_requests_total{job="zero1-app", status=~"5.."}[5m]) / rate(http_requests_total{job="zero1-app"}[5m]) * 100 > 5
        for: 2m
        labels:
          severity: critical
        annotations:
          summary: "–í—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –æ—à–∏–±–æ–∫"
          description: "Error rate is {{ $value }}%"

      # –ê–ª–µ—Ä—Ç—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
      - alert: DatabaseDown
        expr: up{job="postgres"} == 0
        for: 1m
        labels:
          severity: critical
        annotations:
          summary: "–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞"
          description: "PostgreSQL instance is down"

      - alert: HighDatabaseConnections
        expr: pg_stat_activity_count > 50
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "–í—ã—Å–æ–∫–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∫ –ë–î"
          description: "{{ $value }} –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π"

      # –ê–ª–µ—Ä—Ç—ã —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
      - alert: MinIODown
        expr: up{job="blackbox", instance="http://minio:9000/minio/health/live"} == 0
        for: 2m
        labels:
          severity: critical
        annotations:
          summary: "MinIO –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"
          description: "Object storage is down"

      - alert: DiskSpaceLow
        expr: (node_filesystem_avail_bytes{mountpoint="/"} / node_filesystem_size_bytes{mountpoint="/"}) * 100 < 10
        for: 5m
        labels:
          severity: critical
        annotations:
          summary: "–ó–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –º–µ—Å—Ç–æ –Ω–∞ –¥–∏—Å–∫–µ"
          description: "Free space is {{ $value }}%"

      # –ë–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫–∏
      - alert: HighCycleFailureRate
        expr: rate(test_cycles_total{status="failed"}[1h]) / rate(test_cycles_total[1h]) * 100 > 10
        for: 30m
        labels:
          severity: critical
        annotations:
          summary: "–í—ã—Å–æ–∫–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç –Ω–µ—É–¥–∞—á–Ω—ã—Ö —Ü–∏–∫–ª–æ–≤"
          description: "Failure rate is {{ $value }}%"

      - alert: NoCompletedCycles
        expr: increase(test_cycles_total{status="completed"}[1h]) == 0
        for: 1h
        labels:
          severity: warning
        annotations:
          summary: "–ù–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö —Ü–∏–∫–ª–æ–≤ –∑–∞ —á–∞—Å"
          description: "–°–∏—Å—Ç–µ–º–∞ –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–¥–∞–Ω–∏—è"
