Appendix K: –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—é –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç–µ–π (Troubleshooting Guide)
K.1. –û–±—â–∞—è –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
K.1.1. –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–æ–µ –¥–µ—Ä–µ–≤–æ —Ä–µ—à–µ–Ω–∏–π
text

–ü—Ä–æ–±–ª–µ–º–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ ‚Üí –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ Kibana (http://localhost:5601) ‚Üí 
‚Üí –ò–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –º–æ–¥—É–ª—å-–∏—Å—Ç–æ—á–Ω–∏–∫ ‚Üí 
‚Üí –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –≤ Grafana ‚Üí 
‚Üí –°–≤–µ—Ä–∏—Ç—å—Å—è —Å —Ç–∞–±–ª–∏—Ü–µ–π —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º (K.2) ‚Üí 
‚Üí –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

K.1.2. –ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
bash

# 1. –û–±—â–∏–π —Å—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã
./manage-system.sh status

# 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –æ—à–∏–±–æ–∫
docker compose logs --tail=50 --timestamps | grep -E "(ERROR|FAILED|exception|timeout)"

# 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
curl -s http://localhost:8000/api/v1/health | jq .
curl -s http://localhost:8080/health | jq .
curl -f http://localhost:9000/minio/health/live
curl -f http://localhost:9200/_cluster/health

# 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞
df -h /var/lib/docker/

# 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è GPU
nvidia-smi --query-gpu=utilization.gpu,memory.used --format=csv

K.2. –¢–∞–±–ª–∏—Ü–∞ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º –∏ —Ä–µ—à–µ–Ω–∏–π
K.2.1. –ü—Ä–æ–±–ª–µ–º—ã —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏
–°–∏–º–ø—Ç–æ–º	–í–æ–∑–º–æ–∂–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞	–†–µ—à–µ–Ω–∏–µ
–û—à–∏–±–∫–∞ Lab initialization timeout –≤ –ª–æ–≥–∞—Ö –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞	EVE-NG API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω	1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å EVE-NG: systemctl status eve-ng
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ç–µ–≤—É—é —Å–≤—è–∑–Ω–æ—Å—Ç—å: ping <eve-ng-ip>
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å EVE-NG: systemctl restart eve-ng
Terraform –Ω–µ –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—é	–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ä–µ—Å—É—Ä—Å–æ–≤ –Ω–∞ —Ö–æ—Å—Ç–µ EVE-NG	1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–≤–æ–±–æ–¥–Ω—É—é –ø–∞–º—è—Ç—å: free -h
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ –æ–±—Ä–∞–∑—ã –≤ EVE-NG
3. –£–≤–µ–ª–∏—á–∏—Ç—å –ª–∏–º–∏—Ç—ã –ø–∞–º—è—Ç–∏ –¥–ª—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω
Ansible –Ω–µ –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ CSR1000v	–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–ª–∏ —Å–µ—Ç–µ–≤—ã–µ ACL	1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ HashiCorp Vault
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å CSR1000v –ø–æ SSH —Å —Ö–æ—Å—Ç–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ firewall –≤ EVE-NG
K.2.2. –ü—Ä–æ–±–ª–µ–º—ã –º–æ–¥—É–ª—è Attack Analyst
–°–∏–º–ø—Ç–æ–º	–í–æ–∑–º–æ–∂–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞	–†–µ—à–µ–Ω–∏–µ
LLM –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Å—Ç–æ–π –∏–ª–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π JSON	–ü—Ä–æ–±–ª–µ–º–∞ —Å –ø—Ä–æ–º–ø—Ç-–∏–Ω–∂–∏–Ω–∏—Ä–∏–Ω–≥–æ–º –∏–ª–∏ –º–æ–¥–µ–ª—å—é	1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ ML-—Å–µ—Ä–≤–∏—Å–∞: docker compose logs ml-service
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –º–æ–¥–µ–ª—å: curl -X POST http://ml-service:8080/models/reload
Netmiko —Ç–∞–π–º–∞—É—Ç –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤—É	–ü—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ç—å—é –∏–ª–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ–º	1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞: nc -zv <device-ip> 22
2. –£–≤–µ–ª–∏—á–∏—Ç—å —Ç–∞–π–º–∞—É—Ç—ã –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Netmiko
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ (CPU)
–ü–∞—Ä—Å–µ—Ä TextFSM –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—ã–≤–æ–¥ CLI	–ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —à–∞–±–ª–æ–Ω–∞	1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å —à–∞–±–ª–æ–Ω–æ–≤ NTC
2. –î–æ–±–∞–≤–∏—Ç—å raw –≤—ã–≤–æ–¥ –≤ –ª–æ–≥ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å fallback-—Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è
K.2.3. –ü—Ä–æ–±–ª–µ–º—ã –º–æ–¥—É–ª—è Attack Executor
–°–∏–º–ø—Ç–æ–º	–í–æ–∑–º–æ–∂–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞	–†–µ—à–µ–Ω–∏–µ
Ping –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç, —Ö–æ—Ç—è —É—è–∑–≤–∏–º–æ—Å—Ç—å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç	–ü—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ç–µ–≤—ã–º —Å—Ç–µ–∫–æ–º –≤ EVE-NG	1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å ARP —Ç–∞–±–ª–∏—Ü—É –Ω–∞ CSR1000v
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å VLAN –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞ –∫–æ–º–º—É—Ç–∞—Ç–æ—Ä–µ
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å firewall –ø—Ä–∞–≤–∏–ª–∞ –Ω–∞ Ubuntu VM
SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∞—Ç–∞–∫—É—é—â–µ–º—É —Ö–æ—Å—Ç—É –ø–∞–¥–∞–µ—Ç	–ü—Ä–æ–±–ª–µ–º—ã —Å —Ä–µ—Å—É—Ä—Å–∞–º–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã	1. –£–≤–µ–ª–∏—á–∏—Ç—å –ø–∞–º—è—Ç—å –¥–ª—è VM –≤ EVE-NG
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ —Ö–æ—Å—Ç–µ EVE-NG
3. –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å VM –∏–∑ —à–∞–±–ª–æ–Ω–∞
K.2.4. –ü—Ä–æ–±–ª–µ–º—ã –º–æ–¥—É–ª—è Remediation
–°–∏–º–ø—Ç–æ–º	–í–æ–∑–º–æ–∂–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞	–†–µ—à–µ–Ω–∏–µ
–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –≤—ã–∑—ã–≤–∞—é—Ç –æ—à–∏–±–∫—É –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ	–°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –∏–ª–∏ –Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–∞—è –∫–æ–º–∞–Ω–¥–∞	1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é IOS –∏ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –∫–æ–º–∞–Ω–¥
2. –í–∫–ª—é—á–∏—Ç—å dry-run —Ä–µ–∂–∏–º –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å show parser dump –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ç—á–∞ –≤—ã–∑—ã–≤–∞–µ—Ç –ø–æ—Ç–µ—Ä—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è	–ö–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è	1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç–∫–∞—Ç –¥–æ–ª–∂–µ–Ω —Å—Ä–∞–±–æ—Ç–∞—Ç—å (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å rollback_logs)
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–Ω–∞–ø—à–æ—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –≤ EVE-NG
3. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ –±—ç–∫–∞–ø–∞ –≤—Ä—É—á–Ω—É—é
K.2.5. –ü—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
–°–∏–º–ø—Ç–æ–º	–í–æ–∑–º–æ–∂–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞	–†–µ—à–µ–Ω–∏–µ
–í—Ä–µ–º—è —Ü–∏–∫–ª–∞ –ø—Ä–µ–≤—ã—à–∞–µ—Ç 120 –º–∏–Ω—É—Ç	–ó–∞–≥—Ä—É–∑–∫–∞ GPU –∏–ª–∏ —Å–µ—Ç–µ–≤—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏	1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Ç–∏–ª–∏–∑–∞—Ü–∏—é GPU: nvidia-smi
2. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞
3. –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ –¥–ª—è –∏–¥–µ–Ω—Ç–∏—á–Ω—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
–í—ã—Å–æ–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ CPU –Ω–∞ —Ö–æ—Å—Ç–µ	–£—Ç–µ—á–∫–∞ –ø–∞–º—è—Ç–∏ –∏–ª–∏ –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–µ —Ü–∏–∫–ª—ã	1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã: docker stats
2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
3. –£–≤–µ–ª–∏—á–∏—Ç—å —Ä–µ—Å—É—Ä—Å—ã —Ö–æ—Å—Ç–∞
K.3. –ü–æ—à–∞–≥–æ–≤—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–±–æ–µ–≤
K.3.1. –ü–æ–ª–Ω–∞—è –ø–æ—Ç–µ—Ä—è —Å–≤—è–∑–∏ —Å EVE-NG
bash

#!/bin/bash
# recovery-eve-ng.sh

echo "üö® –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–≤—è–∑–∏ —Å EVE-NG"

# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑–æ–≤–æ–π —Å–≤—è–∑–Ω–æ—Å—Ç–∏
if ! ping -c 3 ${EVE_NG_IP}; then
    echo "‚ùå EVE-NG –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ IP"
    escalate_to_network_team
    exit 1
fi

# 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤ EVE-NG
if ! curl -f http://${EVE_NG_IP}:8080/api/status; then
    echo "üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ EVE-NG..."
    ssh root@${EVE_NG_IP} "systemctl restart eve-ng"
    sleep 60
fi

# 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏
if ! curl -f http://${EVE_NG_IP}:8080/api/labs/zero1-mvp; then
    echo "üîÑ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏ –∏–∑ —à–∞–±–ª–æ–Ω–∞..."
    curl -X POST http://${EVE_NG_IP}:8080/api/labs \
        -d '{"name": "zero1-mvp", "template": "zero1-base"}'
fi

# 4. –í–∞–ª–∏–¥–∞—Ü–∏—è
if curl -f http://${EVE_NG_IP}:8080/api/labs/zero1-mvp/nodes; then
    echo "‚úÖ EVE-NG –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"
else
    echo "‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å EVE-NG"
    escalate_to_level_3
fi

K.3.2. –ö–æ—Ä—Ä—É–ø—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
bash

#!/bin/bash
# recovery-database-corruption.sh

echo "üóÑÔ∏è  –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –∫–æ—Ä—Ä—É–ø—Ü–∏–∏ –ë–î"

# 1. –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–ø–∏—Å–µ–π –≤ –ë–î
docker compose stop zero1-controller scheduler worker

# 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏
if ! docker compose exec postgres pg_catalog.pg_checkdb(); then
    echo "‚ö†Ô∏è  –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –∫–æ—Ä—Ä—É–ø—Ü–∏—è –ë–î"
    
    # 3. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∞–ø—à–æ—Ç–∞
    LAST_BACKUP=$(aws s3 ls s3://zero1-backups/postgres/ | tail -1 | awk '{print $4}')
    aws s3 cp s3://zero1-backups/postgres/${LAST_BACKUP} /tmp/recovery.sql.gz
    
    # 4. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
    gunzip -c /tmp/recovery.sql.gz | docker compose exec -T postgres psql -U zero1
    
    # 5. –ü—Ä–æ–≤–µ—Ä–∫–∞
    docker compose exec postgres psql -U zero1 -c "SELECT COUNT(*) FROM test_cycles;"
fi

# 6. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤
docker compose start zero1-controller scheduler worker

K.4. –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ —É—Ç–∏–ª–∏—Ç—ã
K.4.1. –°–∫—Ä–∏–ø—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ —Å–∏—Å—Ç–µ–º—ã
python

#!/usr/bin/env python3
"""
zero1-diagnostic.py - –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã
"""

import subprocess
import json
import requests
from datetime import datetime

def check_docker_services():
    """–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è Docker —Å–µ—Ä–≤–∏—Å–æ–≤"""
    result = subprocess.run(
        ["docker", "compose", "ps", "--format", "json"],
        capture_output=True, text=True
    )
    
    services = json.loads(result.stdout)
    unhealthy = [s for s in services if "unhealthy" in s.get("Status", "")]
    
    return {
        "total": len(services),
        "unhealthy": len(unhealthy),
        "details": unhealthy
    }

def check_api_endpoints():
    """–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ API endpoints"""
    endpoints = [
        ("–ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä", "http://localhost:8000/api/v1/health"),
        ("ML-—Å–µ—Ä–≤–∏—Å", "http://localhost:8080/health"),
        ("MinIO", "http://localhost:9000/minio/health/live"),
        ("Elasticsearch", "http://localhost:9200/_cluster/health"),
    ]
    
    results = []
    for name, url in endpoints:
        try:
            response = requests.get(url, timeout=5)
            results.append({
                "service": name,
                "status": "healthy" if response.status_code == 200 else "unhealthy",
                "response_time": response.elapsed.total_seconds()
            })
        except Exception as e:
            results.append({
                "service": name,
                "status": "unreachable",
                "error": str(e)
            })
    
    return results

def check_resource_usage():
    """–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤"""
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏—Å–∫–∞
    disk = subprocess.run(
        ["df", "-h", "/var/lib/docker"],
        capture_output=True, text=True
    ).stdout
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞–º—è—Ç–∏
    memory = subprocess.run(
        ["free", "-h"],
        capture_output=True, text=True
    ).stdout
    
    return {"disk": disk, "memory": memory}

def generate_report():
    """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ—Ç—á–µ—Ç–∞"""
    report = {
        "timestamp": datetime.now().isoformat(),
        "docker_services": check_docker_services(),
        "api_endpoints": check_api_endpoints(),
        "resources": check_resource_usage(),
        "recommendations": []
    }
    
    # –ê–Ω–∞–ª–∏–∑ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
    if report["docker_services"]["unhealthy"] > 0:
        report["recommendations"].append(
            "–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã: ./manage-system.sh restart"
        )
    
    unhealthy_apis = [e for e in report["api_endpoints"] if e["status"] != "healthy"]
    if unhealthy_apis:
        report["recommendations"].append(
            f"–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å API endpoints: {[e['service'] for e in unhealthy_apis]}"
        )
    
    return report

if __name__ == "__main__":
    report = generate_report()
    print(json.dumps(report, indent=2, ensure_ascii=False))

K.4.2. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
bash

#!/bin/bash
# live-monitor.sh

watch -n 5 '
echo "=== Project ZERO-1 Live Monitor ==="
echo "–í—Ä–µ–º—è: $(date)"
echo ""
echo "1. –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤:"
docker compose ps --format "table {{.Name}}\t{{.Status}}\t{{.Ports}}"
echo ""
echo "2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤:"
docker stats --no-stream --format "table {{.Name}}\t{{.CPUPerc}}\t{{.MemUsage}}"
echo ""
echo "3. –ê–∫—Ç–∏–≤–Ω—ã–µ —Ü–∏–∫–ª—ã:"
docker compose exec -T postgres psql -U zero1 -c "SELECT cycle_id, overall_status, start_time FROM test_cycles WHERE overall_status = '"'"'running'"'"';"
'

Appendix L: –ü–æ–ª–∏—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ compliance (Security Policies)
L.1. –ë–∞–∑–æ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
L.1.1. –ü—Ä–∏–Ω—Ü–∏–ø –Ω–∞–∏–º–µ–Ω—å—à–∏—Ö –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π (Least Privilege)
yaml

# zero1-rbac-policies.yml
role_definitions:
  zero1_operator:
    permissions:
      - start_cycle
      - view_reports
      - system_status
    denied:
      - modify_secrets
      - access_raw_data
      - bypass_approval
  
  zero1_auditor:
    permissions:
      - view_all_reports
      - verify_signatures
      - export_evidence
    denied:
      - execute_cycles
      - modify_config
  
  zero1_admin:
    permissions:
      - full_system_access
    constraints:
      - mfa_required: true
      - ip_whitelist: ["10.0.0.0/8"]
      - time_restriction: "08:00-18:00"

L.1.2. Defense in Depth
text

–£—Ä–æ–≤–µ–Ω—å 1: –°–µ—Ç–µ–≤–∞—è —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è (EVE-NG –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–µ—Ç—å)
–£—Ä–æ–≤–µ–Ω—å 2: –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (JWT + MFA)
–£—Ä–æ–≤–µ–Ω—å 3: –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (RBAC)
–£—Ä–æ–≤–µ–Ω—å 4: –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ (TLS 1.3, encrypted volumes)
–£—Ä–æ–≤–µ–Ω—å 5: –ê—É–¥–∏—Ç (–ø–æ–ª–Ω–∞—è traceability, immutable logs)
–£—Ä–æ–≤–µ–Ω—å 6: –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è (Merkle trees, hardware signing)

L.2. –ü–æ–ª–∏—Ç–∏–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö
L.2.1. –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
yaml

data_classes:
  confidential:
    - network_device_configs
    - security_findings
    - credentials
    - digital_signatures
    retention: 7 –ª–µ—Ç
    encryption: –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ (AES-256-GCM)
    access_logging: –ø–æ–ª–Ω–æ–µ
    
  internal:
    - system_logs
    - performance_metrics
    - ml_model_weights
    retention: 1 –≥–æ–¥
    encryption: —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω–æ–µ
    access_logging: –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ
    
  public:
    - anonymized_statistics
    - compliance_reports
    - system_status
    retention: 5 –ª–µ—Ç
    encryption: –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è
    access_logging: –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ

L.2.2. –ü–æ–ª–∏—Ç–∏–∫–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ —É–¥–∞–ª–µ–Ω–∏—è
bash

#!/bin/bash
# data-retention-policy.sh

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö
RETENTION_DAYS=365

echo "üßπ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö..."

# 1. –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö —Ü–∏–∫–ª–æ–≤ –∏–∑ –ë–î
docker compose exec -T postgres psql -U zero1 -c "
    DELETE FROM test_cycles 
    WHERE created_at < NOW() - INTERVAL '${RETENTION_DAYS} days'
    AND overall_status != 'running';
"

# 2. –£–¥–∞–ª–µ–Ω–∏–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ –∏–∑ MinIO
CYCLES_TO_DELETE=$(docker compose exec -T postgres psql -U zero1 -t -c "
    SELECT cycle_id FROM test_cycles 
    WHERE created_at < NOW() - INTERVAL '${RETENTION_DAYS} days';
")

for CYCLE in $CYCLES_TO_DELETE; do
    docker compose run --rm mc rm --recursive --force minio/zero1-artifacts/cycles/${CYCLE}
done

# 3. Rotate –ª–æ–≥–æ–≤ Elasticsearch
curl -X POST "http://localhost:9200/_ilm/policy/zero1_logs_policy/_execute"

L.3. –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º
L.3.1. DISA STIG Compliance
yaml

stig_compliance_framework:
  controls:
    - id: "V-220668"
      description: "Default VLAN not assigned to access ports"
      implementation:
        automated_detection: "Attack Analyst module"
        automated_remediation: "Remediation Synthesizer module"
        verification: "Verification module"
        evidence: "Digital signature in final report"
    
    - id: "V-220543"
      description: "Password encryption required"
      status: "planned_for_phase_1.5"
      
    - id: "V-220521"
      description: "SSH version 2 required"
      status: "planned_for_phase_1.5"

  validation_procedures:
    quarterly_audit:
      frequency: "–∫–∞–∂–¥—ã–µ 3 –º–µ—Å—è—Ü–∞"
      scope: "–≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ STIG"
      method: "–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π + —Ä—É—á–Ω–∞—è –≤—ã–±–æ—Ä–æ—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞"
      responsible: "Chief Security Officer"
    
    continuous_compliance:
      frequency: "–Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ"
      scope: "–∞–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏"
      method: "–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥"
      alerts: "Kibana + Slack notifications"

L.3.2. NIST Cybersecurity Framework
yaml

nist_csf_mapping:
  identify:
    - asset_management: "–†–µ–µ—Å—Ç—Ä –≤—Å–µ—Ö —Å–µ—Ç–µ–≤—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤"
    - risk_assessment: "–û—Ü–µ–Ω–∫–∞ —Ä–∏—Å–∫–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ STIG findings"
    
  protect:
    - access_control: "RBAC, MFA, network segmentation"
    - data_security: "Encryption at rest and in transit"
    - maintenance: "Automated patching through remediation"
    
  detect:
    - anomalies_and_events: "Elasticsearch monitoring and alerting"
    - security_continuous_monitoring: "Real-time verification cycles"
    
  respond:
    - response_planning: "Disaster recovery procedures (Appendix I)"
    - communications: "Alerting system (Slack, email)"
    
  recover:
    - recovery_planning: "Backup and restore procedures"
    - improvements: "Lessons learned from failed cycles"

L.4. –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∏
L.4.1. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª—é—á–∞–º–∏
yaml

key_management_policy:
  hardware_security_modules:
    primary: "YubiKey PIV (FIPS 140-2 Level 2)"
    backup: "Thales HSM (off-site)"
    
  key_generation:
    algorithm: "RSA 4096 –∏–ª–∏ ECC P-384"
    source: "HSM hardware random generator"
    ceremony: "–¥–≤–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ + witness"
    
  key_storage:
    private_keys: "–Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–æ–∫–∏–¥–∞—é—Ç HSM"
    public_keys: "—Ö—Ä–∞–Ω—è—Ç—Å—è –≤ HashiCorp Vault —Å ACL"
    
  key_rotation:
    frequency: "–µ–∂–µ–≥–æ–¥–Ω–æ –∏–ª–∏ –ø—Ä–∏ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏"
    procedure: "–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—É—é –ø–∞—Ä—É, –ø–µ—Ä–µ–ø–æ–¥–ø–∏—Å–∞—Ç—å –∞—Ä—Ö–∏–≤"
    
  revocation:
    conditions:
      - suspected_compromise
      - employee_termination
      - key_expiration
    mechanism: "CRL + OCSP stapling"

L.4.2. –ü–æ–ª–∏—Ç–∏–∫–∞ –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è
python

# signing-policy.py
from cryptography.hazmat.primitives import hashes
from cryptography.hazmat.primitives.asymmetric import padding
from datetime import datetime, timedelta

class SigningPolicy:
    """–ü–æ–ª–∏—Ç–∏–∫–∞ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è"""
    
    VALID_ALGORITHMS = ["RSASSA-PSS", "ECDSA-SHA384"]
    MIN_KEY_SIZE = {"RSA": 3072, "ECC": 256}
    MAX_SIGNATURE_AGE = timedelta(days=365)
    
    @classmethod
    def validate_signature_context(cls, artifact_type, signer_role):
        """–í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è"""
        requirements = {
            "final_report": {
                "allowed_signers": ["zero1_system", "auditor"],
                "required_timestamp": True,
                "requires_counter_signature": True
            },
            "remediation_patch": {
                "allowed_signers": ["zero1_system"],
                "required_timestamp": True,
                "requires_approval": True
            }
        }
        
        if artifact_type not in requirements:
            raise ValueError(f"Unsupported artifact type: {artifact_type}")
        
        req = requirements[artifact_type]
        if signer_role not in req["allowed_signers"]:
            raise ValueError(f"Signer {signer_role} not allowed for {artifact_type}")
        
        return req

L.5. –ü–æ–ª–∏—Ç–∏–∫–∞ –∞—É–¥–∏—Ç–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
L.5.1. –ù–µ–∏–∑–º–µ–Ω—è–µ–º–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
bash

#!/bin/bash
# immutable-logs-setup.sh

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞—É–¥–∏—Ç–∞ Docker
cat > /etc/docker/daemon.json << EOF
{
  "log-driver": "local",
  "log-opts": {
    "max-size": "10m",
    "max-file": "3",
    "compress": "true"
  },
  "live-restore": true
}
EOF

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞—É–¥–∏—Ç–∞ —Å–∏—Å—Ç–µ–º—ã
echo "Setting up immutable audit logs..."
auditctl -w /var/log/zero1/ -p wa -k zero1_audit
auditctl -w /opt/zero1/config/ -p wa -k zero1_config

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∂—É—Ä–Ω–∞–ª–∏—Ä–æ–≤–∞–Ω–∏—è –≤ WORM storage
echo "Configuring WORM storage for audit logs..."
mkdir -p /mnt/worm-storage/zero1-audit
chattr +i /mnt/worm-storage/zero1-audit

L.5.2. –ü–æ–ª–∏—Ç–∏–∫–∞ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã
yaml

incident_response_policy:
  classification:
    severity_levels:
      critical:
        response_time: "15 –º–∏–Ω—É—Ç"
        escalation: "CISO + Legal"
        examples:
          - "–∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è –∫–æ—Ä–Ω–µ–≤–æ–≥–æ –∫–ª—é—á–∞"
          - "–Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏"
      
      high:
        response_time: "1 —á–∞—Å"
        escalation: "Security Team Lead"
        examples:
          - "–æ–±—Ö–æ–¥ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏"
          - "—É—Ç–µ—á–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö"
  
  procedures:
    containment:
      - "–∏–∑–æ–ª—è—Ü–∏—è –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã—Ö —Å–∏—Å—Ç–µ–º"
      - "–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —É—á–µ—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π"
      - "–∞–∫—Ç–∏–≤–∞—Ü–∏—è —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö —Å–∏—Å—Ç–µ–º"
    
    eradication:
      - "–ø–∞—Ç—á–∏–Ω–≥ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π"
      - "—É–¥–∞–ª–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –∫–æ–¥–∞"
      - "—Å–º–µ–Ω–∞ –≤—Å–µ—Ö –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã—Ö –∫–ª—é—á–µ–π"
    
    recovery:
      - "–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –±—ç–∫–∞–ø–æ–≤"
      - "–≤–∞–ª–∏–¥–∞—Ü–∏—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã"
      - "–ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ –∫ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–µ"
    
    lessons_learned:
      frequency: "–ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞ —É—Ä–æ–≤–Ω—è critical –∏–ª–∏ high"
      deliverables:
        - "–æ—Ç—á–µ—Ç –æ–± –∏–Ω—Ü–∏–¥–µ–Ω—Ç–µ"
        - "–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ–¥—É—Ä"
        - "–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ training –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤"

Appendix M: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –∏ —Ç–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
M.1. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
M.1.1. –¢–µ—Å—Ç–æ–≤–∞—è –ø–∏—Ä–∞–º–∏–¥–∞
text

        ‚Üó E2E —Ç–µ—Å—Ç—ã (10%) - –ü–æ–ª–Ω—ã–µ —Ü–∏–∫–ª—ã
       ‚Üó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (20%) - –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–æ–¥—É–ª–µ–π
     ‚Üó –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω—ã–µ —Ç–µ—Å—Ç—ã (30%) - –û—Ç–¥–µ–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏
   ‚Üó –Æ–Ω–∏—Ç —Ç–µ—Å—Ç—ã (40%) - –§—É–Ω–∫—Ü–∏–∏ –∏ –∫–ª–∞—Å—Å—ã

M.1.2. –¢–µ—Å—Ç–æ–≤–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
yaml

# docker-compose.test.yml
services:
  test-postgres:
    image: postgres:16-alpine
    environment:
      POSTGRES_DB: zero1_test
  
  test-minio:
    image: minio/minio
    command: server /data --console-address ":9001"
  
  test-elasticsearch:
    image: elasticsearch:8.11.0
    environment:
      - discovery.type=single-node
      - xpack.security.enabled=false
  
  mock-eve-ng:
    image: python:3.11-slim
    command: python -m http.server 8080
    volumes:
      - ./test_data/mock_responses:/mock_responses
  
  test-runner:
    build:
      context: .
      dockerfile: Dockerfile.test
    depends_on:
      - test-postgres
      - test-minio
      - test-elasticsearch
      - mock-eve-ng

M.2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
M.2.1. –¢–µ—Å—Ç –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ (End-to-End)
python

# tests/test_full_cycle.py
import pytest
import json
from datetime import datetime
from zero1_controller import CycleController
from zero1_orchestrator import Orchestrator

class TestFullCycle:
    """–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –æ—Ç –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –¥–æ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏"""
    
    @pytest.fixture
    def test_environment(self):
        """–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è"""
        return {
            "device_ip": "192.168.1.1",
            "device_type": "cisco_csr1000v",
            "stig_id": "V-220668",
            "expected_vulnerability": "interface Gi2 in VLAN 1"
        }
    
    def test_cycle_happy_path(self, test_environment):
        """–¢–µ—Å—Ç —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞"""
        
        # 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞
        controller = CycleController(test_mode=True)
        
        # 2. –ó–∞–ø—É—Å–∫ —Ü–∏–∫–ª–∞
        cycle_id = controller.start_cycle(
            stig_id=test_environment["stig_id"],
            target_device=test_environment["device_ip"]
        )
        
        # 3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
        max_wait_time = 7200  # 120 –º–∏–Ω—É—Ç
        start_time = datetime.now()
        
        while (datetime.now() - start_time).seconds < max_wait_time:
            status = controller.get_cycle_status(cycle_id)
            
            if status["overall_status"] == "completed":
                # 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
                report = controller.get_cycle_report(cycle_id)
                
                # –ü—Ä–æ–≤–µ—Ä–∫–∏
                assert report["verification_result"] == True
                assert report["digital_signature"] is not None
                assert len(report["artifacts"]) >= 9  # A1-A9
                assert report["merkle_root_verified"] == True
                
                return  # –£—Å–ø–µ—Ö
            
            elif status["overall_status"] == "failed":
                pytest.fail(f"Cycle failed: {status.get('error_message')}")
        
        pytest.fail("Cycle timeout")
    
    def test_rollback_scenario(self):
        """–¢–µ—Å—Ç –æ—Ç–∫–∞—Ç–∞ –ø—Ä–∏ –æ—à–∏–±–∫–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø–∞—Ç—á–∞"""
        
        # 1. –í–Ω–µ–¥—Ä–µ–Ω–∏–µ —Å–±–æ—è
        sabotaged_device = MockDevice()
        sabotaged_device.set_failure_mode("config_apply_failure")
        
        # 2. –ó–∞–ø—É—Å–∫ —Ü–∏–∫–ª–∞
        controller = CycleController()
        cycle_id = controller.start_cycle(
            stig_id="V-220668",
            target_device=sabotaged_device
        )
        
        # 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–∫–∞—Ç–∞
        status = controller.wait_for_completion(cycle_id, timeout=300)
        
        assert status["overall_status"] == "rollback"
        assert sabotaged_device.config_restored_to_backup() == True
        assert controller.rollback_logs_contain(cycle_id, "Remediation Applier") == True
    
    def test_llm_fallback_mechanism(self):
        """–¢–µ—Å—Ç —Ä–∞–±–æ—Ç—ã fallback –ø—Ä–∏ —Å–±–æ–µ LLM"""
        
        # 1. –û—Ç–∫–ª—é—á–µ–Ω–∏–µ ML-—Å–µ—Ä–≤–∏—Å–∞
        ml_service.stop()
        
        # 2. –ó–∞–ø—É—Å–∫ —Ü–∏–∫–ª–∞
        controller = CycleController()
        cycle_id = controller.start_cycle(...)
        
        # 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è fallback-–ø—Ä–∞–≤–∏–ª
        artifacts = controller.get_artifacts(cycle_id)
        analysis_artifact = artifacts.get_by_type("llm_analysis")
        
        # –î–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è rule-based –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä
        assert analysis_artifact["generator"] == "rule_based_fallback"
        assert analysis_artifact["contains_finding"] == True
        
        # 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ü–∏–∫–ª–∞
        status = controller.wait_for_completion(cycle_id)
        assert status["overall_status"] == "completed"

M.2.2. –¢–µ—Å—Ç—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –º–æ–¥—É–ª–µ–π
python

# tests/test_module_integration.py
class TestModuleIntegration:
    
    def test_attack_analyst_to_executor_flow(self):
        """–¢–µ—Å—Ç –ø–µ—Ä–µ–¥–∞—á–∏ –ø–ª–∞–Ω–∞ –∞—Ç–∞–∫–∏ –æ—Ç Analyst –∫ Executor"""
        
        # 1. Analyst –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø–ª–∞–Ω
        analyst = AttackAnalyst()
        config = get_test_device_config()
        analysis = analyst.analyze(config, stig_id="V-220668")
        
        # 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø–ª–∞–Ω–∞
        assert "attack_plan" in analysis
        assert "steps" in analysis["attack_plan"]
        assert len(analysis["attack_plan"]["steps"]) > 0
        
        # 3. Executor –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø–ª–∞–Ω
        executor = AttackExecutor()
        result = executor.execute(analysis["attack_plan"])
        
        # 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        assert "attack_successful" in result
        assert "evidence" in result
        assert "timestamp" in result
        
        # 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –æ–∂–∏–¥–∞–Ω–∏—è–º
        if analysis["findings"][0]["severity"] == "medium":
            assert result["attack_successful"] == True
    
    def test_remediation_synthesis_and_application(self):
        """–¢–µ—Å—Ç —Å–∏–Ω—Ç–µ–∑–∞ –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è"""
        
        # 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
        vulnerability = {
            "stig_id": "V-220668",
            "description": "Interface Gi2 in default VLAN 1",
            "affected_component": "GigabitEthernet2"
        }
        
        attack_report = {
            "attack_successful": True,
            "evidence": "ping succeeded to 192.168.1.100"
        }
        
        # 2. –°–∏–Ω—Ç–µ–∑ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        synthesizer = RemediationSynthesizer()
        patch = synthesizer.generate(
            vulnerability=vulnerability,
            context=attack_report
        )
        
        # 3. –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
        assert patch.validate_syntax() == True
        assert "interface GigabitEthernet2" in patch.commands
        assert "switchport access vlan 100" in patch.commands
        
        # 4. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ (dry-run)
        applier = RemediationApplier(dry_run=True)
        apply_result = applier.apply(patch, target_device)
        
        # 5. –ü—Ä–æ–≤–µ—Ä–∫–∞
        assert apply_result["success"] == True
        assert apply_result["validation_passed"] == True
        assert apply_result["rollback_prepared"] == True
    
    def test_evidence_chain_integrity(self):
        """–¢–µ—Å—Ç —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ —Ü–µ–ø–æ—á–∫–∏ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤"""
        
        # 1. –°–±–æ—Ä –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ü–∏–∫–ª–∞
        artifacts = [
            Artifact(type="config", data=initial_config, hash=sha256(initial_config)),
            Artifact(type="analysis", data=analysis_report, hash=sha256(analysis_report)),
            Artifact(type="attack", data=attack_result, hash=sha256(attack_result)),
            Artifact(type="remediation", data=patch, hash=sha256(patch)),
            Artifact(type="verification", data=verification, hash=sha256(verification))
        ]
        
        # 2. –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ Merkle Tree
        merkle_builder = MerkleTreeBuilder()
        tree = merkle_builder.build(artifacts)
        
        # 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏
        for artifact in artifacts:
            proof = tree.get_proof(artifact.hash)
            assert merkle_builder.verify_proof(
                leaf_hash=artifact.hash,
                proof=proof,
                root_hash=tree.root
            ) == True
        
        # 4. –ü–æ–¥–ø–∏—Å–∞–Ω–∏–µ –∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è
        signer = DigitalSigner()
        signature = signer.sign(tree.root)
        
        assert signer.verify(tree.root, signature) == True

M.3. –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
M.3.1. –¢–∞–±–ª–∏—Ü–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
yaml

test_scenarios:
  - id: "SCENARIO-001"
    name: "–£—Å–ø–µ—à–Ω–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏"
    preconditions:
      - "–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∏–º–µ–µ—Ç –ø–æ—Ä—Ç –≤ VLAN 1"
      - "–¶–µ–ª–µ–≤–æ–π —Ö–æ—Å—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –≤ VLAN 1"
    steps:
      - "–ó–∞–ø—É—Å–∫ —Ü–∏–∫–ª–∞ —Å STIG V-220668"
      - "–û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è"
    expected_results:
      - "–¶–∏–∫–ª –∑–∞–≤–µ—Ä—à–µ–Ω —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º completed"
      - "–û—Ç—á–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç —Ü–∏—Ñ—Ä–æ–≤—É—é –ø–æ–¥–ø–∏—Å—å"
      - "–ü–æ—Ä—Ç –ø–µ—Ä–µ–º–µ—â–µ–Ω –≤ VLAN 100"
      - "–ü–æ–≤—Ç–æ—Ä–Ω–∞—è –∞—Ç–∞–∫–∞ –Ω–µ—É—Å–ø–µ—à–Ω–∞"
    
  - id: "SCENARIO-002"
    name: "–û–±—Ä–∞–±–æ—Ç–∫–∞ –ª–æ–∂–Ω–æ–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è"
    preconditions:
      - "–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ù–ï –∏–º–µ–µ—Ç –ø–æ—Ä—Ç–æ–≤ –≤ VLAN 1"
      - "LLM –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –≥–∏–ø–µ—Ä—á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å"
    steps:
      - "–ó–∞–ø—É—Å–∫ —Ü–∏–∫–ª–∞ —Å STIG V-220668"
      - "–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤"
    expected_results:
      - "Attack Analyst –Ω–µ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç —É—è–∑–≤–∏–º–æ—Å—Ç—å"
      - "–¶–∏–∫–ª –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –¥–æ—Å—Ä–æ—á–Ω–æ —Å appropriate —Å—Ç–∞—Ç—É—Å–æ–º"
      - "–í –ª–æ–≥–∞—Ö –∑–∞–ø–∏—Å—å –æ –ø—Ä–æ–≤–µ—Ä–∫–µ –∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ findings"
    
  - id: "SCENARIO-003"
    name: "–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ —Å–µ—Ç–µ–≤–æ–≥–æ —Å–±–æ—è"
    preconditions:
      - "–¶–∏–∫–ª –∑–∞–ø—É—â–µ–Ω"
      - "–°–µ—Ç–µ–≤–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ–º –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ"
    steps:
      - "–ò–º–∏—Ç–∞—Ü–∏—è –æ–±—Ä—ã–≤–∞ —Å–µ—Ç–∏ –≤–æ –≤—Ä–µ–º—è –∞–Ω–∞–ª–∏–∑–∞"
      - "–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ç–∏ —á–µ—Ä–µ–∑ 60 —Å–µ–∫—É–Ω–¥"
    expected_results:
      - "–°–∏—Å—Ç–µ–º–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç retry (–¥–æ 3 –ø–æ–ø—ã—Ç–æ–∫)"
      - "–ü—Ä–∏ –Ω–µ—É–¥–∞—á–µ - –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –æ—Ç–∫–∞—Ç"
      - "–õ–æ–≥–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç –∑–∞–ø–∏—Å–∏ –æ —Ç–∞–π–º–∞—É—Ç–∞—Ö –∏ retry"
    
  - id: "SCENARIO-004"
    name: "–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–∫–∞–∑–∞ ML-—Å–µ—Ä–≤–∏—Å–∞"
    preconditions:
      - "ML-—Å–µ—Ä–≤–∏—Å —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ"
      - "Fallback –ø—Ä–∞–≤–∏–ª–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã"
    steps:
      - "–û—Å—Ç–∞–Ω–æ–≤–∫–∞ ML-—Å–µ—Ä–≤–∏—Å–∞ –≤–æ –≤—Ä–µ–º—è –∞–Ω–∞–ª–∏–∑–∞"
      - "–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ–∞–∫—Ü–∏–∏ —Å–∏—Å—Ç–µ–º—ã"
    expected_results:
      - "–°–∏—Å—Ç–µ–º–∞ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ rule-based –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä"
      - "–¶–∏–∫–ª –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ (–≤–æ–∑–º–æ–∂–Ω–æ —Å degraded —Ç–æ—á–Ω–æ—Å—Ç—å—é)"
      - "–õ–æ–≥–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç warning –æ fallback –∞–∫—Ç–∏–≤–∞—Ü–∏–∏"
    
  - id: "SCENARIO-005"
    name: "–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π"
    preconditions:
      - "–°–∏—Å—Ç–µ–º–∞ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–∞ –≤ production-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏"
      - "10 –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –≥–æ—Ç–æ–≤—ã –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é"
    steps:
      - "–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ 10 —Ü–∏–∫–ª–æ–≤"
      - "–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–µ—Ç—Ä–∏–∫ –≤ —Ç–µ—á–µ–Ω–∏–µ 2 —á–∞—Å–æ–≤"
    expected_results:
      - "–í—Å–µ —Ü–∏–∫–ª—ã –∑–∞–≤–µ—Ä—à–∞—é—Ç—Å—è –≤ —Ç–µ—á–µ–Ω–∏–µ 120 –º–∏–Ω—É—Ç"
      - "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ GPU –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç 80%"
      - "–ù–µ –±–æ–ª–µ–µ 5% —Ü–∏–∫–ª–æ–≤ —Ç—Ä–µ–±—É—é—Ç –æ—Ç–∫–∞—Ç–∞"
      - "–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è —Ü–∏–∫–ª–∞ < 90 –º–∏–Ω—É—Ç"

M.3.2. –°–∫—Ä–∏–ø—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
python

#!/usr/bin/env python3
"""
test-scenario-runner.py - –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
"""

import yaml
import asyncio
from dataclasses import dataclass
from typing import Dict, List
from enum import Enum

class TestStatus(Enum):
    PENDING = "pending"
    RUNNING = "running"
    PASSED = "passed"
    FAILED = "failed"
    SKIPPED = "skipped"

@dataclass
class TestResult:
    scenario_id: str
    status: TestStatus
    duration: float
    logs: List[str]
    artifacts: Dict

class TestScenarioRunner:
    def __init__(self, scenarios_file: str):
        with open(scenarios_file, 'r') as f:
            self.scenarios = yaml.safe_load(f)['test_scenarios']
        
        self.results = []
    
    async def run_scenario(self, scenario: Dict) -> TestResult:
        """–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è"""
        result = TestResult(
            scenario_id=scenario['id'],
            status=TestStatus.RUNNING,
            duration=0.0,
            logs=[],
            artifacts={}
        )
        
        try:
            # –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
            await self.setup_environment(scenario['preconditions'])
            
            # –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —à–∞–≥–æ–≤
            start_time = asyncio.get_event_loop().time()
            
            for step in scenario['steps']:
                await self.execute_step(step, result)
            
            result.duration = asyncio.get_event_loop().time() - start_time
            
            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–∂–∏–¥–∞–µ–º—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
            await self.verify_results(scenario['expected_results'], result)
            
            result.status = TestStatus.PASSED
            
        except Exception as e:
            result.status = TestStatus.FAILED
            result.logs.append(f"ERROR: {str(e)}")
        
        finally:
            await self.cleanup()
        
        return result
    
    async def run_all_scenarios(self):
        """–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤"""
        print(f"üöÄ –ó–∞–ø—É—Å–∫ {len(self.scenarios)} —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤")
        
        for scenario in self.scenarios:
            print(f"\nüìã –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏—è: {scenario['name']}")
            
            result = await self.run_scenario(scenario)
            self.results.append(result)
            
            print(f"   –°—Ç–∞—Ç—É—Å: {result.status.value}")
            print(f"   –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: {result.duration:.2f} —Å–µ–∫—É–Ω–¥")
        
        # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞
        self.generate_report()
    
    def generate_report(self):
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏—Ç–æ–≥–æ–≤–æ–≥–æ –æ—Ç—á–µ—Ç–∞"""
        passed = sum(1 for r in self.results if r.status == TestStatus.PASSED)
        failed = sum(1 for r in self.results if r.status == TestStatus.FAILED)
        
        report = {
            "summary": {
                "total": len(self.results),
                "passed": passed,
                "failed": failed,
                "success_rate": (passed / len(self.results)) * 100
            },
            "detailed_results": [
                {
                    "scenario_id": r.scenario_id,
                    "status": r.status.value,
                    "duration": r.duration,
                    "log_count": len(r.logs)
                }
                for r in self.results
            ]
        }
        
        # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ç—á–µ—Ç–∞
        with open('/tmp/test_execution_report.json', 'w') as f:
            json.dump(report, f, indent=2)
        
        print(f"\nüìä –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç:")
        print(f"   –£—Å–ø–µ—à–Ω–æ: {passed}/{len(self.results)}")
        print(f"   –£—Å–ø–µ—à–Ω–æ—Å—Ç—å: {report['summary']['success_rate']:.1f}%")
        print(f"   –û—Ç—á–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω: /tmp/test_execution_report.json")

async def main():
    runner = TestScenarioRunner('test_scenarios.yml')
    await runner.run_all_scenarios()

if __name__ == "__main__":
    asyncio.run(main())

M.4. –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
M.4.1. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è GitHub Actions
yaml

# .github/workflows/ci-cd.yml
name: CI/CD Pipeline

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main]

jobs:
  unit-tests:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Run unit tests
        run: |
          docker compose -f docker-compose.test.yml run --rm test-runner \
            pytest tests/unit/ -v --cov=zero1 --cov-report=xml
      
      - name: Upload coverage
        uses: codecov/codecov-action@v3
        with:
          file: ./coverage.xml
  
  integration-tests:
    runs-on: ubuntu-latest
    needs: unit-tests
    steps:
      - uses: actions/checkout@v3
      
      - name: Run integration tests
        run: |
          docker compose -f docker-compose.test.yml up -d
          docker compose -f docker-compose.test.yml run --rm test-runner \
            pytest tests/integration/ -v
      
      - name: Test report
        if: always()
        run: |
          cat /tmp/test_execution_report.json
  
  security-scan:
    runs-on: ubuntu-latest
    needs: integration-tests
    steps:
      - uses: actions/checkout@v3
      
      - name: Run security scan
        run: |
          docker scan zero1-controller:latest --severity high
          docker scan zero1-ml-service:latest --severity high
      
      - name: STIG compliance check
        run: |
          python scripts/compliance_check.py --profile stig

  performance-tests:
    runs-on: [self-hosted, gpu]
    needs: security-scan
    steps:
      - uses: actions/checkout@v3
      
      - name: Run performance tests
        run: |
          locust -f tests/performance/locustfile.py \
            --host=http://localhost:8000 \
            --users=10 \
            --spawn-rate=1 \
            --run-time=1h \
            --csv=performance_results
      
      - name: Upload performance report
        uses: actions/upload-artifact@v3
        with:
          name: performance-report
          path: performance_results*.csv

M.4.2. –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞ –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã
yaml

# .pre-commit-config.yaml
repos:
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.4.0
    hooks:
      - id: trailing-whitespace
      - id: end-of-file-fixer
      - id: check-yaml
      - id: check-json
      - id: check-added-large-files
  
  - repo: https://github.com/psf/black
    rev: 23.3.0
    hooks:
      - id: black
        language_version: python3.11
  
  - repo: https://github.com/PyCQA/flake8
    rev: 6.0.0
    hooks:
      - id: flake8
        additional_dependencies: [flake8-docstrings]
  
  - repo: https://github.com/PyCQA/isort
    rev: 5.12.0
    hooks:
      - id: isort
  
  - repo: https://github.com/pre-commit/mirrors-mypy
    rev: v1.3.0
    hooks:
      - id: mypy
        additional_dependencies: [types-requests, types-PyYAML]
  
  - repo: https://github.com/commitizen-tools/commitizen
    rev: v3.5.3
    hooks:
      - id: commitizen
        stages: [commit-msg]

–ò—Ç–æ–≥–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —Ä–∞–∑–¥–µ–ª–æ–≤:
1. –ü–æ–ª–Ω–æ—Ç–∞ –ø–æ–∫—Ä—ã—Ç–∏—è

–°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã –¥–æ–ø–æ–ª–Ω—è—é—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è:

    –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—É—é –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ troubleshooting guide

    –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ä–µ–≥—É–ª—è—Ç–æ—Ä–Ω—ã–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º —á–µ—Ä–µ–∑ security policies

    –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å –∏ –∫–∞—á–µ—Å—Ç–≤–æ —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

2. –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å —Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π

–í—Å–µ —Ä–∞–∑–¥–µ–ª—ã:

    –°—Å—ã–ª–∞—é—Ç—Å—è –Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

    –ò—Å–ø–æ–ª—å–∑—É—é—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –≤ –¢–ó —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

    –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –∑–∞—è–≤–ª–µ–Ω–Ω—ã–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º

3. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å

    Troubleshooting guide —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –∏ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã

    Security policies —Ä–µ–∞–ª–∏–∑—É–µ–º—ã –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º—ã

    –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –ø–æ–∫—Ä—ã–≤–∞—é—Ç –≤—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—É—Ç–∏ —Å–∏—Å—Ç–µ–º—ã

4. –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å

    –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä—è—Ç—å –¥–ª—è –Ω–æ–≤—ã—Ö –º–æ–¥—É–ª–µ–π

    –ü–æ–ª–∏—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∞–¥–∞–ø—Ç–∏—Ä—É—é—Ç—Å—è –ø–æ–¥ –Ω–æ–≤—ã–µ compliance —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

    –¢–µ—Å—Ç–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤


